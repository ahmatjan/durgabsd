#!/bin/bash
# This is part of Hcon Security Testing Framework v0.5 from Hcon.in
# this script is licensed under GPL but if you modify this script that you must submit the modified source to the author
#author : Ashish Mistry
#website: www.Hcon.in
clear
echo
echo -e " \e[1;31m    ==  ==                    ====== ====== ====== \e[0m "
echo -e " \e[1;31m    ==  ==                    ==       ==   == \e[0m "
echo -e " \e[1;37m    ====== ===== ===== ==   = ======   ==   ====== \e[0m "
echo -e " \e[1;37m    ==  == =     =   = = =  =     ==   ==   == \e[0m "
echo -e " \e[1;32m    ==  == =     =   = =  = =     ==   ==   == \e[0m "
echo -e " \e[1;32m    ==  == ===== ===== =   == ======   ==   == \e[0m "
echo -e " \e[1;35m             vesrion 0.5 codename Prime \e[0m "
echo -e " \e[1;36m           By Ashish Mistry | www.Hcon.in \e[0m "
echo
if [ "$(whoami)" != 'root' ]; then
   echo -e " \e[0;34m    ##############################################\e[0m"
   echo -e "     \e[0;34m#\e[0m \e[0;31m You need root permissions to run HconSTF \e[0m \e[0;34m#\e[0m"
   echo -e "     \e[0;34m#\e[0m \e[0;31m            Run\e[0m \e[1;37msudo ./HconSTF            \e[0m \e[0;34m#\e[0m"
   echo -e " \e[0;34m    ##############################################\e[0m"
   echo
   exit 1;
else
   echo -e " \e[0;34m    ##############################################\e[0m"
   echo -e "     \e[0;34m#\e[0m \e[0;31m            Initiating HconSTF            \e[0m \e[0;34m#\e[0m"
   echo -e " \e[0;34m    ##############################################\e[0m"
   echo
   bash -c './App/HconSTF -no-remote -profile ./Data'
   wait
#log start
   mv ./Data/Desktop/http-request-log.txt ~/Desktop
   mv ~/Desktop/http-request-log.txt ~/Desktop/HconSTF_log.txt
   chmod 666 ~/Desktop/HconSTF_log.txt
#log end
   clear
   echo
   echo -e " \e[1;31m    ==  ==                    ====== ====== ====== \e[0m "
   echo -e " \e[1;31m    ==  ==                    ==       ==   == \e[0m "
   echo -e " \e[1;37m    ====== ===== ===== ==   = ======   ==   ====== \e[0m "
   echo -e " \e[1;37m    ==  == =     =   = = =  =     ==   ==   == \e[0m "
   echo -e " \e[1;32m    ==  == =     =   = =  = =     ==   ==   == \e[0m "
   echo -e " \e[1;32m    ==  == ===== ===== =   == ======   ==   == \e[0m "
   echo -e " \e[1;35m             vesrion 0.5 codename Prime \e[0m "
   echo -e " \e[1;36m           By Ashish Mistry | www.Hcon.in \e[0m "
   echo
   echo -e " \e[0;34m    ##############################################\e[0m"
   echo -e "     \e[0;34m#\e[0m \e[0;31m        Created Log on your Desktop       \e[0m \e[0;34m#\e[0m"
   echo -e " \e[0;34m    ##############################################\e[0m"
   echo -e "     \e[0;34m#\e[0m                                            \e[0;34m#\e[0m"
   echo -e "     \e[0;34m#\e[0m         \e[0;31mRun HconSTF Cleaner now ?\e[0m          \e[0;34m#\e[0m"
   echo -e "     \e[0;34m#\e[0m         \e[1;31m1\e[0m. \e[1;31myes\e[0m                             \e[0;34m#\e[0m"
   echo -e "     \e[0;34m#\e[0m         \e[1;31m2\e[0m. \e[1;31mno\e[0m                              \e[0;34m#\e[0m"
   echo -e "     \e[0;34m#\e[0m                                            \e[0;34m#\e[0m"
   echo -e " \e[0;34m    ##############################################\e[0m"
   read -p "               Enter your choice (1 or 2): " option
   if [ $option -eq 1 ]; then
     clear
#cleaner code start
     echo
     echo -e " \e[1;31m    ==  ==                    ====== ====== ====== \e[0m "
     echo -e " \e[1;31m    ==  ==                    ==       ==   == \e[0m "
     echo -e " \e[1;37m    ====== ===== ===== ==   = ======   ==   ====== \e[0m "
     echo -e " \e[1;37m    ==  == =     =   = = =  =     ==   ==   == \e[0m "
     echo -e " \e[1;32m    ==  == =     =   = =  = =     ==   ==   == \e[0m "
     echo -e " \e[1;32m    ==  == ===== ===== =   == ======   ==   == \e[0m "
     echo -e " \e[1;35m             vesrion 0.5 codename Prime \e[0m "
     echo -e " \e[1;36m           By Ashish Mistry | www.Hcon.in \e[0m "
     echo
     echo -e " \e[0;34m    ##############################################\e[0m"
     echo -e "     \e[0;34m#\e[0m           \e[0;31mRunning HconSTF cleaner\e[0m          \e[0;34m#\e[0m"
     echo -e " \e[0;34m    ##############################################\e[0m"
     rm ./Data/urlclassifier3.sqlite
     rm ./Data/permissions.sqlite
     rm ./Data/formhistory.sqlite
     rm ./Data/downloads.sqlite
     rm ./Data/cookies.sqlite
     rm ./Data/content-prefs.sqlite
     rm ./Data/signons.sqlite
     rm ./Data/places.sqlite
     rm ./Data/places.sqlite-journal
     rm ./Data/sessions/*.session
     rm ./Data/cert8.db
     rm ./Data/secmod.db
     rm ./Data/key3.db
     rm ./Data/search.json
     rm ./Data/OfflineCache/index.sqlite
     rm ./Data/webappsstore.sqlite
     rm ./Data/sessionstore.js
     rm ./Data/sessionstore.bak
     rm ./Data/search.sqlite
     rm ./Data/chromeappsstore.sqlite
     rm -r ./Data/safebrowsing/*
     rm ./Data/places.sqlite-shm
     rm ./Data/places.sqlite-wal
     rm ./Data/extensions.log
     rm ./Data/urlclassifier.pset
     rm ./Data/minidumps/*.*
     rm ./Data/thumbnails/*.*
     rm ./Data/firebug/*.*
     rm -r ./Data/sessions/*
#cleaning up bookmarks, this will reset to default bookmarks of HconSTF and will delete your added : rm ./Data/bookmarkbackups/*.json
#delete the 'quickfox notes' backups : rm -r ./Data/qfn-backups/*
#cleaner code end
     wait
     clear
     echo
     echo -e " \e[1;31m    ==  ==                    ====== ====== ====== \e[0m "
     echo -e " \e[1;31m    ==  ==                    ==       ==   == \e[0m "
     echo -e " \e[1;37m    ====== ===== ===== ==   = ======   ==   ====== \e[0m "
     echo -e " \e[1;37m    ==  == =     =   = = =  =     ==   ==   == \e[0m "
     echo -e " \e[1;32m    ==  == =     =   = =  = =     ==   ==   == \e[0m "
     echo -e " \e[1;32m    ==  == ===== ===== =   == ======   ==   == \e[0m "
     echo -e " \e[1;35m             vesrion 0.5 codename Prime \e[0m "
     echo -e " \e[1;36m           By Ashish Mistry | www.Hcon.in \e[0m "
     echo
     echo -e " \e[0;34m    ##############################################\e[0m"
     echo -e "     \e[0;34m#\e[0m     \e[0;31mCleaning completed, Exiting HconSTF\e[0m    \e[0;34m#\e[0m"
     echo -e " \e[0;34m    ##############################################\e[0m"
     echo
     sleep 4
   else
     clear
     echo
     echo -e " \e[1;31m    ==  ==                    ====== ====== ====== \e[0m "
     echo -e " \e[1;31m    ==  ==                    ==       ==   == \e[0m "
     echo -e " \e[1;37m    ====== ===== ===== ==   = ======   ==   ====== \e[0m "
     echo -e " \e[1;37m    ==  == =     =   = = =  =     ==   ==   == \e[0m "
     echo -e " \e[1;32m    ==  == =     =   = =  = =     ==   ==   == \e[0m "
     echo -e " \e[1;32m    ==  == ===== ===== =   == ======   ==   == \e[0m "
     echo -e " \e[1;35m             vesrion 0.5 codename Prime \e[0m "
     echo -e " \e[1;36m           By Ashish Mistry | www.Hcon.in \e[0m "
     echo
     echo -e " \e[0;34m    ##############################################\e[0m"
     echo -e "     \e[0;34m#\e[0m     \e[0;31mNOT runing Cleaner, Exiting HconSTF\e[0m    \e[0;34m#\e[0m"
     echo -e " \e[0;34m    ##############################################\e[0m"
     echo
     sleep 4
   fi
fi
