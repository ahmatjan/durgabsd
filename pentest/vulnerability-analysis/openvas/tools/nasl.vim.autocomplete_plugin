function! NaslDictGrep(sbase, dfiles)
    try
        exe 'vimgrep /^\s*' . a:sbase . '.*/j ' . a:dfiles
    catch /.*/
        echo "no matches"
    endtry
endfunction

function! NaslComplete(findstart, findbase)
    if a:findstart
        return match(getline("."),"[^ \t\"',=+][^ \t\"',=+]*$")
    else
        let dpath = "~/.vim/openvas/vim_autocomplete_nasl_func_names"
        call NaslDictGrep( escape(a:findbase, '\\/.*$^~[]'), dpath )
        let lmatch = []
        if(a:findbase == '')
                        call add(lmatch, {'word': 'a', 'menu': ''})
                endif
        for matchline in getqflist()
                                let mword =  matchstr(matchline.text,'\S.*\S')
                                call add(lmatch, {'word': mword, 'menu': ''})
        endfor
        call setqflist([])
        return lmatch
    endif
endfunction
