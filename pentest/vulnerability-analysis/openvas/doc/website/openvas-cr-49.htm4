m4_dnl -*-html-*-
m4_include(`template.m4')

m4_dnl OpenVAS
m4_dnl $Id$
m4_dnl Description: OpenVAS Change Request #49
m4_dnl
m4_dnl Authors:
m4_dnl Michael Wiegand <michael.wiegand@greenbone.net>
m4_dnl
m4_dnl Copyright:
m4_dnl Copyright (C) 2010 Greenbone Networks GmbH
m4_dnl
m4_dnl This program is free software; you can redistribute it and/or
m4_dnl modify it under the terms of the GNU General Public License
m4_dnl as published by the Free Software Foundation; either version 2
m4_dnl of the License, or (at your option) any later version.
m4_dnl
m4_dnl This program is distributed in the hope that it will be useful,
m4_dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
m4_dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
m4_dnl GNU General Public License for more details.
m4_dnl
m4_dnl You should have received a copy of the GNU General Public License
m4_dnl along with this program; if not, write to the Free Software
m4_dnl Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.

m4_define(`EN')
m4_define(`TITLE', `OpenVAS')
m4_define(`MAIN', `misc')



PAGE_START
<h2>OpenVAS Change Request #49: Introduce new phase for network scans</h2>

<p>
Status: Voted +9. Implemented it SVN revision <a href="http://wald.intevation.org/scm/viewvc.php?view=rev&root=openvas&revision=9365">9365</a> and <a href="http://wald.intevation.org/scm/viewvc.php?view=rev&root=openvas&revision=9366">9366</a>.
</p>

<h3>Purpose</h3>

<p>
To make scanning large networks more effective and to simplify integration of
network based external tools.
</p>

<h3>References</h3>

<ul>
<li><a href="http://lists.wald.intevation.org/pipermail/openvas-devel/2010-October/002422.html">Initial proposal and patch</a></li>
<li><a href="http://lists.wald.intevation.org/pipermail/openvas-devel/2010-November/002452.html">Clarification and updated patch</a></li>
</ul>

<h3>Rationale</h3>

<p>
<b>Please note:</b> This change request draws heavily from <a
href="http://www.openvas.org/openvas-cr-26.html">Change Request #26</a> and
intends to make the proposal more specific. Many thanks to Vlatko Kosturjak for
the initial Change Request.
</p>

<p>
Currently, OpenVAS is a host oriented vulnerability scanner. That means that it
forks for each IP tested and for each NVT. In some cases it would be more
effective in terms of memory usage and scan speed to launch an NVT a single time
against a group of hosts or an entire network.  Launching nmap is one of the
cases.
</p>

<p>
NVTs always belong to one category (e.g. "ACT_INIT", "ACT_ATTACK", "ACT_END")
which correlates with the phase of the scan in which the NVT is run.
</p>

<h3>Effects</h3>

<h4>Advantages</h4>

<ul>
<li>
Running NVTs that are able to collect information on a network level would
become a lot easier and more effective.
</li>
<li>
Integrating external tools that operate on a network level (e.g. nmap) would
become a lot easier and more effective.
</li>
</ul>

<h4>Disadvantages</h4>

<ul>
<li>
In order to use this new functionality, NVT authors will need to make a few
minor adjustments to their NVTs.
</li>
</ul>

<h3>Design and Implementation</h3>

<p>
To enable openvas-scanner to collect information on the network level, a new
scan phase for certain NVTs (e.g. port scanners) should be introduced to allow
them to gather information on this level. This scan phase will have the
following special properties:
</p>

<ul>
<li>
NVTs can use the new <i>scan_phase</i> command to determine the current scan
phase.
</li>
<li>
When NVTs run in the network scan phase, they can use the new
<i>network_targets</i> command to determine the targets for this phase.
</li>
<li>
NVTs in this phase operate on a knowledge base (KB) separate from the per host
KBs and will store information gathered about individual hosts prefixed with the
IP of the host, e.g. "192.168.12.34/Ports/tcp/80=1".
</li>
<li>
When preparing a scan of an individual host, openvas-scanner will look for
entries matching the IP of the current target in the network level KB. If
entries are present in this KB, they are copied to the host KB and are then
available to all NVTs running against this target.
</li>
</ul>

<h3>History</h3>

<ul>
<li> 2010-11-09 Michael Wiegand &lt;michael dot wiegand at greenbone dot net&gt;:<br>
     Updated status.
</li>
<li> 2010-11-02 Michael Wiegand &lt;michael dot wiegand at greenbone dot net&gt;:<br>
     Added references.
</li>
<li> 2010-11-01 Michael Wiegand &lt;michael dot wiegand at greenbone dot net&gt;:<br>
     Updated to better reflect actual implementation and to provide better
     examples.
</li>
<li> 2010-07-29 Michael Wiegand &lt;michael dot wiegand at greenbone dot net&gt;:<br>
     Initial text based on Change Request #26.
</li>
</ul>
