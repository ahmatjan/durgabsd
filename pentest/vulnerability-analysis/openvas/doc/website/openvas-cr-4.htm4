m4_dnl -*-html-*-
m4_include(`template.m4')

m4_dnl OpenVAS
m4_dnl $Id$
m4_dnl Description: OpenVAS Change Request #4
m4_dnl
m4_dnl Authors:
m4_dnl Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>
m4_dnl
m4_dnl Copyright:
m4_dnl Copyright (C) 2008 Intevation GmbH
m4_dnl
m4_dnl This program is free software; you can redistribute it and/or
m4_dnl modify it under the terms of the GNU General Public License
m4_dnl as published by the Free Software Foundation; either version 2
m4_dnl of the License, or (at your option) any later version.
m4_dnl
m4_dnl This program is distributed in the hope that it will be useful,
m4_dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
m4_dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
m4_dnl GNU General Public License for more details.
m4_dnl
m4_dnl You should have received a copy of the GNU General Public License
m4_dnl along with this program; if not, write to the Free Software
m4_dnl Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.

m4_define(`EN')
m4_define(`TITLE', `OpenVAS')
m4_define(`MAIN', `misc')



PAGE_START
<h2>OpenVAS Change Request #4: Remove plugin upload feature</h2>

Status: Voted +4. Done. Feature is no longer present in OpenVAS 2.0.

<h3>Purpose</h3>

<p>
To reduce code base.
</p>

<p>
To avoid the risk of security problems.
</p>

<h3>References</h3>

<p>
none.
</p>

<h3>Rationale</h3>

<p>
This feature was introduced in Nessus version 1.1.11
according to openvas-server/CHANGES.
</p>

<p>
Uploaded script are a potential source of security problems.
They are executed regardless of the the signature policy
and for example can include and execute .inc files even
if they have a invalid signature.
</p>

<p>
Apart from this, the feature seems not really required in
practice. This assumption is supported by the fact that
OpenVAS-Client (and thus Nessus-Client) did not implement a feature
to upload plugins.
</p>

<h3>Effects</h3>

<ul>
<li> Clients will not be able anymore to use the protocol
     command "ATTACHED_PLUGIN" with the OpenVAS server
     and will receive a protocol error when trying so.
<li> Directories $prefix/var/openvas/users/<user>/plugins/
     will not be created via "openvas-add-user".
     Existing ones are not considered anymore and can be removed.
<li> The setting "admin_user", "plugin_upload" and
     "plugin_upload_suffixes" in openvasd.conf will not be
     considered anymore and can be removed.
<li> Undocumented NTP protocol command HUP_FATHER will
     not be available anymore.
<li> Those users that were configured as admin via "admin_user" will
     not be able anymore to override max_checks and max_hosts.
</ul>

<h3>Design and Implementation</h3>

<ul>
<li> While keeping NTP11 protocol: Alway deny upon a ATTACHED_PLUGIN
     command.
<li> After protocol upgrade: Remove module
     openvas-server/openvasd/pluginupload.c|h and its use.
<li> Remove handling of configuration parameters "plugin_upload"
     and "plugin_upload_suffixes" in module openvas-server/openvasd/preferences.c
     and openvas-server/openvasd/ntp_11.c.
<li> After protocol upgrade: NTP protocol keywords
     "ATTACHED_PLUGIN" should be removed from
     openvas-server/openvasd/ntp_11.c and
     openvas-server/doc/ntp/ntp_extensions.txt.
</ul>

<h3>History</h3>

<ul>
<li> 2008-02-14 Jan-Oliver Wagner &lt;jan-oliver.wagner@intevation.de&gt;:<br>
     Initial text.
<li> 2008-02-23 Jan-Oliver Wagner &lt;jan-oliver.wagner@intevation.de&gt;:<br>
     Updated status with result of voting.
<li> 2008-05-09 Jan-Oliver Wagner &lt;jan-oliver.wagner@intevation.de&gt;:<br>
     Updated status, effects and implementation.
<li> 2008-10-21 Michael Wiegand &lt;michael.wiegand@intevation.de&gt;:<br>
     Updated status.
<li> 2008-12-29 Michael Wiegand &lt;michaek.wiegabd@intevation.de&gt;:<br>
     Updated status.
</ul>
