m4_dnl -*-html-*-
m4_include(`template.m4')

m4_dnl OpenVAS
m4_dnl $Id$
m4_dnl Description: OpenVAS Change Request #44
m4_dnl
m4_dnl Authors:
m4_dnl Chandrashekhar B <bchandra@secpod.com>
m4_dnl
m4_dnl Copyright:
m4_dnl Copyright (C) 2010 SecPod
m4_dnl
m4_dnl This program is free software; you can redistribute it and/or modify
m4_dnl it under the terms of the GNU General Public License version 2,
m4_dnl or, at your option, any later version as published by the Free
m4_dnl Software Foundation
m4_dnl
m4_dnl This program is distributed in the hope that it will be useful,
m4_dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
m4_dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
m4_dnl GNU General Public License for more details.
m4_dnl
m4_dnl You should have received a copy of the GNU General Public License
m4_dnl along with this program; if not, write to the Free Software
m4_dnl Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.

m4_define(`EN')
m4_define(`TITLE', `OpenVAS')
m4_define(`MAIN', `misc')



PAGE_START
<h2>OpenVAS Change Request #44: Integrating NMAP NSE's into OpenVAS</h2>

Status: Voted +3. Done. First NSE wrappers appeared in OpenVAS NVT Feed since 2010-08-10.

<h3>Purpose</h3>

<p>
  To have OpenVAS Server manage NSE scripts from NMAP analogous to NASL tests
  and possibly distribute NSE scripts as additional NVT's in with the OpenVAS NVT Feed.
</p>

<h3>References</h3>

<p>
  <a href="http://nmap.org/book/nse.html">General information about NMAP NSE
  (http://nmap.org/book/nse.html)</a><br>
</p>

<p>
<a href="openvas-cr-13.html">OpenVAS Change Request #13: Integrating the OVAL 
interpreter ovaldi into OpenVAS Server</a>
</p>

<h3>Rationale</h3>

<p>
The Nmap Scripting Engine (NSE) allows users to write simple scripts to
automate networking tasks. NSE scripts are generally used for network
discovery, vulnerability detection and exploitation.
</p>

<p>
It is advantageous for OpenVAS to have the facility to launch NSE scripts
(through NMAP) directly as they are because these tests cover aspects the
NASL script don't (or even can't).
This will be a value-addition for the NVT feed.
</p>

<p>
Furthermore, this aligns with the goal of having tighter integration of NMAP
and OpenVAS, with the already existing port scanning, service detection from
NMAP.
</p>

<h3>Effects</h3>
<ul>
  <li> Wrappers for NMAP's NSE scripts will be distributed along with NVT feed. Users will
  be able to seamlessly configure and run NSE scripts through OpenVAS.
</ul>

<h3>Design</h3>
<p>
OpenVAS will allow each NSE script to be loaded and launched like the way it
handles NVT's.
</p>

<p>
The practical implementation will not be analog to the ovaldi-integration for OVAL
scripts, because the NSE scripts do not offer a consistent scheme to inform
their capabilities and needs, for example preferences.
</p>

<h4>NASL Wrapper for NSE scripts</h4>

<p>
The meta data for NSE scripts will be collected in a NASL wrapper for
each NSE script. These wrapper scripts will take care of launching nmap with the
respective preferences, issue messages according to the results and handle errors.
</p>

<h4>ID's for NSE scripts</h4>

<p>
NVTs are identified by OIDs within OpenVAS. NSE's are not associated with 
any identifiers. Since for each NSE a individual wrapper needs to be developed,
the ID scheme should follow the current practice of ranges assigned for
developers/developer teams.
</p>

<h4>Integration of NSE scripts into the feed</h4>

<p>
A new subdirectory "Nmap" in the feed would carry
the .nasl-wrapper for the .nse-files.
The actual NSE scripts are the ones from the system
wide installation. The Wrapper will take care to
check for the applicable nmap version.
</p>

<h3>Implementation</h3>

<p>
No modifications of the scanner are required.
It is a pure NASL-based solution: For each NSE script
a NASL wrapper is to be implemented.
</p>


<h3>History</h3>

<ul>
<li> 2010-07-15 Jan-Oliver Wagner &lt;jan-oliver.wagner@greenbone.net&gt;:<br>
     Reworked again. NSE's of system is used. Only wrapper is distributed via Feed.</li>
<li> 2010-06-29 Jan-Oliver Wagner &lt;jan-oliver.wagner@greenbone.net&gt;:<br>
     Reworked and simplified concept to be a pure NASL approach.</li>
<li> 2010-02-26 Jan-Oliver Wagner &lt;jan-oliver.wagner@greenbone.net&gt;:<br>
     Fixed some typos. Updated Rationale: 0-day should not be promised by OpenVAS
     as it would surely need more than 1 day to add new NSEs into the Feed.
     Clearified Purpose.</li>
<li> 2010-02-25 Chandrashekhar B &lt;bchandra@secpod.com&gt;:<br>
     Initial text.</li>
</ul>
