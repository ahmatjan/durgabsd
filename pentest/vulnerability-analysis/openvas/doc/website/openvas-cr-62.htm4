m4_dnl -*-html-*-
m4_include(`template.m4')

m4_dnl OpenVAS
m4_dnl $Id$
m4_dnl Description: OpenVAS Change Request #62 (Distributed KB with Redis)
m4_dnl
m4_dnl Authors:
m4_dnl Henri Doreau <henri.doreau@gmail.com>
m4_dnl
m4_dnl Copyright:
m4_dnl Copyright (C) 2014 Greenbone Networks GmbH
m4_dnl
m4_dnl This program is free software; you can redistribute it and/or
m4_dnl modify it under the terms of the GNU General Public License
m4_dnl as published by the Free Software Foundation; either version 2
m4_dnl of the License, or (at your option) any later version.
m4_dnl
m4_dnl This program is distributed in the hope that it will be useful,
m4_dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
m4_dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
m4_dnl GNU General Public License for more details.
m4_dnl
m4_dnl You should have received a copy of the GNU General Public License
m4_dnl along with this program; if not, write to the Free Software
m4_dnl Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.

m4_define(`EN')
m4_define(`TITLE', `OpenVAS')
m4_define(`MAIN', `misc')

PAGE_START
<h2>OpenVAS Change Request #62: Distributed KB with Redis</h2>

<p>
Status: Voted +3. Done as r19309, r19310.
</p>

<h3>Purpose</h3>

<p>
Improve scalability and ability to trace/debug the KB by exporting it to an
autonomous server. We propose to use Redis, a key/value store.
</p>

<h3>References</h3>

<ul>
  <li>
    Initial proposition and PoC patch at OpenVAS DevCon #4 (Hildesheim, 2013).
  </li>
  <li>
    Redis homepage: <a href="http://redis.io/">http://redis.io/</a>
  </li>
  <li>
    <a href="http://lists.wald.intevation.org/pipermail/openvas-devel/2014-January/003304.html">Patch for OpenVAS on OpenVAS development mailing list</a>
  </li>
</ul>

<h3>Rationale</h3>

<p>
Currently, the KB is stored in RAM and populated/queried via a communication
tree established through the multiple scanner processes.
</p>

<p>
The existing KB code is getting hard to extend and suffers several limitations.
It is not trivial to trace the activity of the KB or to enforce consistent
and structured data models within the KB.
</p>

<p>
Delegating the management of the KB to an autonomous (and possibly remote)
server allows new features to be developed, easier tracing and let us expect
higher performances (shared KB, advanced data structures...).
Redis is a key/value store that would fit such needs.
It allows remote concurrent processes to populate and query structured datasets.
</p>

<h3>Effects</h3>

<p>
It would make redis become a dependency of OpenVAS. Redis is a small ANSI C
server, distributed under the terms of the BSD license. It has a very active
community and is used in a variety of projects and areas. The scanner would have
to be linked against a redis client library (like hiredis). Redis 2.4 and 2.6
should be supported to guarantee compatibility with most GNU/Linux distributions.
</p>

<p>
The feature can be implemented to export an interface that is extremely similar
to the existing one, thus requiring only minor changes to the scanner code
itself. Once the feature is considered stable and mature enough, the interface
could be simplified or extended in a way that would allow OpenVAS to leverage
more features from Redis. The access to redis would (at least initially) be done
through a Unix socket, so that standard filesystem permissions can be used to
control access to the KB.
</p>

<h3>Design and Implementation</h3>

<p>
The following steps would need to be done:
</p>

<ol>

<li>
<p>
Specify and implement the KB interface that is to be exported to the scanner.
</p>
</li>

<li>
<p>
Implement a Redis-based backend.
</p>
</li>

<li>
<p>
Determine and document the recommended configuration and settings for redis with
OpenVAS.
</p>
</li>

</ol>

<h3>History</h3>

<ul>
  <li> 2013-12-26 Henri Doreau &lt;henri.doreau at gmail dot com&gt;:<br/>
    Initial text.
  </li>
  <li> 2014-01-10 Jan-Oliver Wagner &lt;jan-oliver.wagner@greenbone.net&gt;:<br/>
    Added references and fixed typo.
  </li>
  <li> 2014-02-28 Henri Doreau &lt;henri.doreau at gmail dot com&gt;:<br/>
    Added supported versions of redis.
  </li>
  <li> 2014-04-23 Henri Doreau &lt;henri.doreau at gmail dot com&gt;:<br/>
    Added voting results and set status to "in development".
  </li>
  <li> 2014-04-23 Henri Doreau &lt;henri.doreau at gmail dot com&gt;:<br/>
    Set status to "Done".
  </li>
</ul>
