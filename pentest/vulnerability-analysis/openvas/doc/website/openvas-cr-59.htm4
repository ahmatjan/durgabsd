m4_dnl -*-html-*-
m4_include(`template.m4')

m4_dnl OpenVAS
m4_dnl $Id$
m4_dnl Description: OpenVAS Change Request #59 (NVT Feed Improvements 4)
m4_dnl
m4_dnl Authors:
m4_dnl Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>
m4_dnl
m4_dnl Copyright:
m4_dnl Copyright (C) 2011, 2012 Greenbone Networks GmbH
m4_dnl
m4_dnl This program is free software; you can redistribute it and/or
m4_dnl modify it under the terms of the GNU General Public License
m4_dnl as published by the Free Software Foundation; either version 2
m4_dnl of the License, or (at your option) any later version.
m4_dnl
m4_dnl This program is distributed in the hope that it will be useful,
m4_dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
m4_dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
m4_dnl GNU General Public License for more details.
m4_dnl
m4_dnl You should have received a copy of the GNU General Public License
m4_dnl along with this program; if not, write to the Free Software
m4_dnl Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.

m4_define(`EN')
m4_define(`TITLE', `OpenVAS')
m4_define(`MAIN', `misc')

PAGE_START
<h2>OpenVAS Change Request #59: NVT Feed message consolidation</h2>

<p>
Status: Voted +5. In Progress.
</p>

<h3>References</h3>

<ul>
  <li> (none)
  </li>
</ul>

<h3>Purpose</h3>

<p>
Consolidation of messages sent by NVTs in order to
simplify writing a NVT, lower maintenance effort
and avoid mistakes due to redundancies.
</p>

<h3>Rationale</h3>

<p>
Currently 3 types of messages define a security alert: security_hole(),
security_warning() and security_note(). So far the use was decided by
the authors of a NVT and do not necessarily correspond to the CVSS. Especially
because CVSS can change over time.
</p>

<p>
A single message type "security_message()" for security alerts would be sufficient
once all NVTs are associated with CVSS values. The risk/severity can
then be decided automatically.
</p>

<p>
This would mean to reduce from total 5 to total 3 message types: security_message(),
log_message() and debug_message().
</p>

<h3>Effects</h3>

<p>
No immediate effect for OpenVAS-4 users.
</p>

<p>
It would be optional to start using security_message for NVT developments.
</p>

<p>
After OpenVAS-4 is retired, NVT developers don't need to consider
different severity message types anymore and all remaining NVTs can be converted
to use security_message only.
</p>

<h3>Design and Implementation</h3>

<p>
As a precondition it is necessary that all NVTs using security_message
do offer a CVSS (which is in progress, see CR#58).
</p>

<p>
As a first step the NASL method security_message() is added.
However, there is no immediate need to use this function already now.
In fact it should only be used for NVTs that do have a CVSS already.
After OpenVAS-4 retired, in one go, all security_note, security_warning and security_hole
can be renamed to security_message in all of the NVTs.
</p>

<p>
For OpenVAS-5, internally the functions security_hole, security_warning
and security_note are mapped to security_message. The function security_message
will look into the CVSS and then actually call the respective command
using the currently applied CVSS range scheme.
</p>

<p>
Developments beyond OpenVAS-5 can remove the mapping in scanner and instead
send the message right to Manager who then decides the current status.
Thats is, however, another story.
</p>

<p>
Some NVTs currently use more than one message type (e.g. security_hole
and security_warning, depending on some detections).
Either this behaviour is in conflict with associated CVEs. Or if indeed
it makes sense regarding the severity, then in fact it should be split
into two NVTs. Each of them dealing with an aspect of a certain severity.
</p>

<p>
To treat some special situations optional parameters (cvss and msgtype)
for security_message are added
that allows to specify a certain CVSS is available. cvss is a value like "9.6"
and msgtype is one of "hole", "warning", "note".
This is also helpful for the transitional phase.
</p>

<p>
After OpenVAS-4 retired, all (semi-)automated NVT creation needs to be adapted
to only apply security_message().
</p>

<h3>History</h3>

<ul>
  <li> 2012-02-09 Jan-Oliver Wagner &lt;jan-oliver.wagner at greenbone dot net&gt;:<br/>
    Marked as "In Pogress" after vote.
  </li>

  <li> 2012-02-03 Jan-Oliver Wagner &lt;jan-oliver.wagner at greenbone dot net&gt;:<br/>
    Updated the change request.
  </li>

  <li> 2011-11-01 Jan-Oliver Wagner &lt;jan-oliver.wagner at greenbone dot net&gt;:<br/>
    Changed implementation concept regarding legacy options. In fact these are not
    necessary at all and we save one change process of all NVTs. Thanks for Thomas Reinke
    for this idea.
  </li>
  <li> 2011-10-30 Jan-Oliver Wagner &lt;jan-oliver.wagner at greenbone dot net&gt;:<br/>
    Initial text.
  </li>
</ul>
