m4_dnl -*-html-*-
m4_include(`template.m4')

m4_dnl OpenVAS
m4_dnl $Id$
m4_dnl Description: OpenVAS Change Request #61 (NVT Description break-up)
m4_dnl
m4_dnl Authors:
m4_dnl Hani Benhabiles <hani.benhabiles@greenbone.net>
m4_dnl
m4_dnl Copyright:
m4_dnl Copyright (C) 2013 Greenbone Networks GmbH
m4_dnl
m4_dnl This program is free software; you can redistribute it and/or
m4_dnl modify it under the terms of the GNU General Public License
m4_dnl as published by the Free Software Foundation; either version 2
m4_dnl of the License, or (at your option) any later version.
m4_dnl
m4_dnl This program is distributed in the hope that it will be useful,
m4_dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
m4_dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
m4_dnl GNU General Public License for more details.
m4_dnl
m4_dnl You should have received a copy of the GNU General Public License
m4_dnl along with this program; if not, write to the Free Software
m4_dnl Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.

m4_define(`EN')
m4_define(`TITLE', `OpenVAS')
m4_define(`MAIN', `misc')

PAGE_START
<h2>OpenVAS Change Request #61: NVT Description break-up</h2>

<p>
Status: Voted +6. Completed in October 2013.
</p>

<h3>Purpose</h3>

<p>
Improve NVT plugins meta-information organization.
Extract common information blocks from NVT Description field into script xrefs
and tags.
</p>

<h3>References</h3>

<ul>
  <li>
  <a href="http://lists.wald.intevation.org/pipermail/openvas-plugins/2011-November/000722.html">
    Discussion on mailing list openvas-plugins from November 2011</a>
  </li>
  <li>
  <a href="http://lists.wald.intevation.org/pipermail/openvas-plugins/2013-January/000934.html">
    Discussion on mailing list openvas-plugins from January 2013</a>
  </li>
  <li>
  <a href="http://lists.wald.intevation.org/pipermail/openvas-plugins/2013-February/000958.html">
    Next stage discussion on mailing list openvas-plugins from February 2013</a>
  </li>
  <li>
  <a href="https://scm.wald.intevation.org/svn/openvas/trunk/openvas-plugins/scripts/2013/gb_nero_mediahome_server_mult_dos_vuln.nasl">
    Sample script: Nero MediaHome Server Multiple Remote DoS Vulnerabilities</a>
  </li>
  <li>
  <a href="https://scm.wald.intevation.org/svn/openvas/trunk/openvas-plugins/scripts/secpod_xpdf_mult_vuln.nasl">
    Sample script: Xpdf Multiple Vulnerabilities</a>
  </li>
</ul>

<h3>Rationale</h3>

<p>
Currently, a good chunk of NVT plugins meta-information is dumped as-is under
headers/titles in the NVT Description field. Examples of such information
includes References, Vulnerability Insight, Vulnerability Detection, Affected
Software/OS, Solution/Fix etc,. This makes extracting and displaying relevant
content for the user less practical.
</p>

<p>
This gets worse because of the lack of a formal and unique structure for the
included information in NVT Description field, making the information structure
less consistent between different NVT plugins.
</p>

<p>
Moving these information blocks into relevant script tags would make using them
easier and less tedious.
</p>

<p>
Another reason for the description refinement is that it allows improved
reporting on scan results. It can be more refined on the one hand and on the
other hand it is possible to offer different levels of detail (short, medium,
full.)
</p>
<h3>Effects</h3>

<p>
In order to stay backward compatible (until OpenVAS-5 EOL), the extracted
information blocks should be kept in the Description field (as well as
inserted into the script tags.) These information blocks will be stored in
string variables in the NVT script to stay consistent between both fields.
Once all the supported OpenVAS versions include the needed fixes and
improvements to adapt to the script tags changes, this duplication will be
removed from the NVT Description field.
</p>

<p>
It would take some time to convert most of the plugins that are currently
included in the feed repository. Tools used to auto-generate plugins also need
to be adapted to generated plugins in this new style. It will also take some
extra handcrafting work to adapt writing plugins in order to get a structured
and coherent format for all new plugins.
</p>

<h3>Design and Implementation</h3>

<p>
The following steps would need to be done:
</p>

<ol>

<li>
<p>
Define a set of information blocks to extract from the NVT Description
field. This should also define a new plugin structure to be respected by newly
written plugins:
<ul>
<li>Summary</li>
<li>Vulnerability Detection</li>
<li>Vulnerability Insight</li>
<li>Impact</li>
<li>Affected Software/OS</li>
<li>Solution</li>
<li>References</li>
</ul>
</p>
</li>

<li>
<p>
Write a script to convert the set of already included plugins by extracting the
relevant information blocks into string variables that will be inserted (back)
in the description field as well script tags while staying backward compatible
with older OpenVAS versions by using a conditional version check before
inserting the new script tags.
</p>
</li>

<li>
<p>
Adapt tools like LSC Generator to generate plugins respecting the new plugins
style.
</p>
</li>

</ol>

<h3>History</h3>

<ul>
  <li> 2013-10-31 Jan-Oliver Wagner &lt;jan-oliver.wagner at greenbone dot net&gt;:<br/>
    Updated status to completed.
  <li> 2013-04-16 Jan-Oliver Wagner &lt;jan-oliver.wagner at greenbone dot net&gt;:<br/>
    Updated status to voted and in development.
  <li> 2013-03-25 Jan-Oliver Wagner &lt;jan-oliver.wagner at greenbone dot net&gt;:<br/>
    Detailed information blocks.
  <li> 2013-03-25 Hani Benhabiles &lt;hani.benhabiles at greenbone dot net&gt;:<br/>
    Initial text.
  </li>
</ul>
