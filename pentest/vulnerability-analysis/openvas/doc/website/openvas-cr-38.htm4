m4_dnl -*-html-*-
m4_include(`template.m4')

m4_dnl OpenVAS
m4_dnl $Id$
m4_dnl Description: OpenVAS Change Request #38
m4_dnl
m4_dnl Authors:
m4_dnl Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>
m4_dnl
m4_dnl Copyright:
m4_dnl Copyright (C) 2009 Greenbone Networks GmbH
m4_dnl
m4_dnl This program is free software; you can redistribute it and/or
m4_dnl modify it under the terms of the GNU General Public License
m4_dnl as published by the Free Software Foundation; either version 2
m4_dnl of the License, or (at your option) any later version.
m4_dnl
m4_dnl This program is distributed in the hope that it will be useful,
m4_dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
m4_dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
m4_dnl GNU General Public License for more details.
m4_dnl
m4_dnl You should have received a copy of the GNU General Public License
m4_dnl along with this program; if not, write to the Free Software
m4_dnl Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.

m4_define(`EN')
m4_define(`TITLE', `OpenVAS')
m4_define(`MAIN', `misc')



PAGE_START
<h2>OpenVAS Change Request #38: Reorganize OpenVAS libraries</h2>

Status: Voted +6. Done in subversion trunk (past 2.0) since 2009-09-01.

<h3>Purpose</h3>

<p>
Consolidate all libraries of the OpenVAS tool chain.
</p>

<p>
To prevent code redundancies (duplication of same code in various modules).
</p>

<p>
Simplified release management and installation.
</p>

<h3>References</h3>

<p>
This change was discussed in a session at the OpenVAS DevCon-2
in July 2009.
</p>

<h3>Rationale</h3>

<p>
A survey on libraries spread over OpenVAS toolchain shows:
</p>

<ul>
<li> openvas-libraries:libopenvas
<li> openvas-libraries:libopenvas_hg
<li> openvas-client:libnessus (static, modified copy of libopenvas)
<li> openvas-libnasl:libopenvasnasl
<li> openvas-manager:libomp (static)
<li> openvas-manager:libotp (static)
<li> openvas-manager:libmanage (static)
<li> openvas-manager:libstring (static)
<li> openvas-manager:libfile (static)
<li> openvas-manager:libovas-mngr-comm (static)
<li> openvas-manager:libcommon (static)
</ul>

<p>
Modules that will use the consolidated form of openvas-libraries would be:
</p>

<ul>
<li> openvas-client
<li> openvas-server
<li> openvas-manager
<li> openvas-config-manager
<li> arbitrary individually crafted clients
</ul>

<p>
From the maintenance perspective (technically as well as
in terms of copyright and license), a consolidation
will less trouble new developers. Clean rules on
where to place API elements will provide a guide
to more easily involve into the developments.
</p>

<p>
Apart from that, source code transparency is
improved as well.
</p>

<h3>Effects</h3>

<p>
No effects for users, because these are internal changes.
</p>

<p>
Packagers need to adjust packaging. It does make sense
to produce separate binary packages, each containing
a library. That way, the clients need only to require
the library packages of relevance.
</p>

<p>
In fact, this means to retire the module "openvas-libnasl".
All of its contents would move into "openvas-libraries".
</p>

<p>
A side effect is that the glib minimum requirement needs to be raised
to 2.12 for some of the libraries from openvas-manager.
</p>

<h3>Design and Implementation</h3>

<p>
Central idea is to collect any library in openvas-libraries module.
This essentially means also to migrate libopenvasnasl into this module
and to retire the module openvas-libnasl.
</p>

<p>
The new set of libraries inside openvas-libraries should be as follows:
</p>

<ul>
<li> openvas-libraries/nasl: The nasl library (contents of
     openvas-libnasl/nasl)
<li> openvas-libraries/base: openvas-libraries/libopenvascommon/ and all
     other basic API methods that are of general use but do not involve
     other dependencies than glib. libfile should be integrated here as well.
<li> openvas-libraries/misc: All old stuff from openvas-libraries/libopenvas
     which is not being re-inmplemented or obsoleted over time.
     Eventually this library should be empty and then removed.
<li> openvas-libraries/hg: openvas-libraries/libopenvas_hg, remains as is
     until consolidated into other library or resolved in another way.
<li> openvas-libraries/net: Low-level networking functions that require
     dependencies to low level system libraries.
<li> openvas-libraries/omp: API for OMP clients (libcommon from
     openvas-manager as a start.  Needs to be extended with full API).
<li> openvas-libraries/otp: API for OTP clients.  Empty initially, with the
     idea of extending to a full API in the future.
</ul>

<p>
The other libraries of openvas-manager (libomp, libotp, libmanage,
libopenvas-mngr-comm and libstring) remain with that module as long as they
are not required by any other module.  libomp and libotp need to be renamed
as they clash with openvas-libraries.
</p>

<p>
The contents of all libraries except for nasl, misc and hg are entirely
new developments with clean GPL v2+ licensing.
</p>

<p>
It is still to decide whether to move towards cmake and disregard
the current autotools approach for configuration of source code
package. As autotools and cmake do not necessarily conflict
when used in the same module, the new libraries will be managed
via cmake. Eventually the whole module can get rid of the
autotools.
</p>

<p>
Since there are going to be a lot of changes and the ABI might not be
backwards compatible it should be ensured there is a SONAME bump when the
libraries change so that people don't try to mix older versions of
openvas-{client,server} with the new libraries provided by
openvas-libraries.
</p>

<h3>History</h3>

<ul>
<li> 2009-09-03 Jan-Oliver Wagner &lt;jan-oliver.wagner@greenbone.net&gt;:<br>
     Setting status to "done".</li>
<li> 2009-08-12 Jan-Oliver Wagner &lt;jan-oliver.wagner@greenbone.net&gt;:<br>
     Added voting result and set to "in progress".</li>
<li> 2009-08-03 Jan-Oliver Wagner &lt;jan-oliver.wagner@greenbone.net&gt;:<br>
     Added hints from Javier about SONAME.</li>
<li> 2009-07-31 Jan-Oliver Wagner &lt;jan-oliver.wagner@greenbone.net&gt;:<br>
     Some little clarifications, especially more effects.</li>
<li> 2009-07-16 Matthew Mundell &lt;matthew.mundell@intevation.de&gt;:<br>
     Adjust actions on libomp and libotp.</li>
<li> 2009-07-14 Jan-Oliver Wagner &lt;jan-oliver.wagner@intevation.de&gt;:<br>
     Initial text. This is a result of a session at OpenVAS DevCon2.</li>
</ul>
