m4_dnl -*-html-*-
m4_include(`template.m4')

m4_dnl OpenVAS
m4_dnl $Id$
m4_dnl Description: OpenVAS Security Advisory (OVSA20131108)
m4_dnl
m4_dnl Authors:
m4_dnl Tim Brown <timb@openvas.org>
m4_dnl
m4_dnl Copyright:
m4_dnl Copyright (C) 2013 Tim Brown
m4_dnl
m4_dnl This program is free software; you can redistribute it and/or modify
m4_dnl it under the terms of the GNU General Public License version 2,
m4_dnl or, at your option, any later version as published by the Free
m4_dnl Software Foundation
m4_dnl
m4_dnl This program is distributed in the hope that it will be useful,
m4_dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
m4_dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
m4_dnl GNU General Public License for more details.
m4_dnl
m4_dnl You should have received a copy of the GNU General Public License
m4_dnl along with this program; if not, write to the Free Software
m4_dnl Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.

m4_define(`EN')
m4_define(`TITLE', `OpenVAS')
m4_define(`MAIN', `misc')



PAGE_START
<h2>OpenVAS Security Advisory (OVSA20131108)</h2>

<p>
Date: 8th November 2013<br/>
Product: OpenVAS Manager &lt; 3.0.7 and &lt; 4.0.4 and OpenVAS Administrator &lt; 1.2.2 and &lt; 1.3.2<br/>
Vendor: OpenVAS &lt;http://www.openvas.org/&gt;
Risk: Low
</p>

<h3>Summary</h3>

<p>
It has been identified that OpenVAS Manager and OpenVAS Administrator are
vulnerable to authentication bypass due to an incorrect state assignment when
processing OMP and OAP requests.  It has been identified that this
vulnerability may allow unauthorised access to OpenVAS Manager and OpenVAS
Administrator on vulnerable systems.  CVE-2013-6765 has been assigned to this
vulnerability in Manager and CVE-2013-6766 to the same vulnerability in
Administrator.
</p>

<p>
It should be noted that not all of the newly available commands are functional
and that exploitation typically requires SSH access to the host on which the 
services are installed.
</p>

<h3>Current Status</h3>

<p>
As of the 8th November, the state of the vulnerabilities is believed
to be as follows.  Patches have been supplied by Greenbone Networks which
it successfully resolves this vulnerability.  New releases of both OpenVAS
Manager and OpenVAS Administrator have also been created which incorporate
these patches.
</p>

<h3>Technical Details</h3>

<p>
It has been identified that OpenVAS Manager and OpenVAS Administrator are
vulnerable to authentication bypass due to an invalid state assignment when
processing OMP and OAP requests.
</p>

<p>
Upon processing an OMP and OAP request to retrieve the version information
from OpenVAS Administrator and OpenVAS Manager, the state is incorrectly set
to CLIENT_AUTHENTIC, allowing additional OMP and OAP commands to be called.  
This can be seen in the omp_xml_handle_end_element() function from omp.c (for
OpenVAS Manager):
</p>

<pre>
if (client_state)
  set_client_state (CLIENT_AUTHENTIC);
else
  set_client_state (CLIENT_TOP);
break;
</pre>

<p>
In this instance, the first condition will always hold.  Rather, the check
should be whether client_state is currently set to CLIENT_GET_VERSION_AUTHENTIC.
</p>

<p>
It should be noted that not all of the newly available commands are functional, 
since they often rely upon additional session state information being present
which will not be the case where the authentication has been bypassed.
</p>

<p>
Furthermore, the vulnerable code path is typically only accessible to users
who have logged into a host running OpenVAS Manager or OpenVAS Administrator
via SSH as the affected services are typically only bound to localhost.
</p>

<h3>Fix</h3>

<p>
OpenVAS recommends that the publicly available patches are applied.  If
building from source, then patches r18285 (for OpenVAS Administrator 1.2.x) or
r18281 (for Administrator 1.3.x) and r18276 (for OpenVAS Manager 3.0.x) or
r18271 (for Manager 4.0.x) should be obtained from the OpenVAS SVN repository.
</p>

<p>
A fresh tarball containing the latest stable release of Administrator
can be obtained from:
</p>

<ul>
<li>http://wald.intevation.org/frs/download.php/1442/openvas-administrator-1.3.2.tar.gz</li>
</ul>

<p>
A fresh tarball containing the latest stable release of Manager
can be obtained from:
</p>

<ul>
<li>http://wald.intevation.org/frs/download.php/1434/openvas-manager-4.0.4.tar.gz</li>
</ul>

<p>
In the event that OpenVAS has been supplied as part of a distribution then
the vendor or organisation concerned should be contacted for a patch.  Known
major distributors of OpenVAS precompiled packages have already been notified.
</p>

<h3>History</h3>

<p>
On the 3rd August 2013, Antonio Sanchez Arago initially attempted to contact the
OpenVAS security team to report the issue in OpenVAS Manager however it was
missed as many of the team were on annual leave.
</p>

<p>
Unfortunately, it was not picked up until Antonio attempted to contact us again
on in late October.  On this occasion, it was picked up and the team were able
to reproduce the vulnerability.
</p>

<p>
On the 7th November, we contacted Antonio to confirm that the team had
successfully reproduced the issue and Greenbone Networks to notify them of the
vulnerability and request assistance in coordinating the disclosure.  Major
distributors of OpenVAS precompiled packages were also notified about the 
upcoming patches.
</p>

<p>
New versions of both OpenVAS Manager and OpenVAS Administrator were released on
the 8th.
</p>

<p>
The OpenVAS security team then contacted MITRE and on the 9th November,
CVE-2013-6764 and CVE-2013-6766 were assigned for this vulnerability.
</p>

<h3>Thanks</h3>

<p>
OpenVAS would like to thank Antonio Sanchez Arago of INTECO for his help in
reporting the vulnerability and apologise to all concerned for the
substantial delay in triaging his report.
</p>
