m4_dnl -*-html-*-
m4_include(`template.m4')

m4_dnl OpenVAS
m4_dnl $Id$
m4_dnl Description: OpenVAS Change Request #22
m4_dnl
m4_dnl Authors:
m4_dnl Michael Wiegand <michael.wiegand@intevation.de>
m4_dnl
m4_dnl Copyright:
m4_dnl Copyright (C) 2008 Intevation GmbH
m4_dnl
m4_dnl This program is free software; you can redistribute it and/or
m4_dnl modify it under the terms of the GNU General Public License
m4_dnl as published by the Free Software Foundation; either version 2
m4_dnl of the License, or (at your option) any later version.
m4_dnl
m4_dnl This program is distributed in the hope that it will be useful,
m4_dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
m4_dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
m4_dnl GNU General Public License for more details.
m4_dnl
m4_dnl You should have received a copy of the GNU General Public License
m4_dnl along with this program; if not, write to the Free Software
m4_dnl Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.

m4_define(`EN')
m4_define(`TITLE', `OpenVAS')
m4_define(`MAIN', `misc')



PAGE_START
<h2>OpenVAS Change Request #22: OpenVAS-libnasl: Introduce new script_tag Command</h2>

<p>
Status: Voted +3. Done. The script_tag command is available starting with OPENVAS_NASL_LEVEL 2310 (OpenVAS 2.0.0).
</p>

<h3>Purpose</h3>

<p>
To make NVT descriptions more flexible, thus enabling a more flexible NVT
handling in both client and server.
</p>

<p>
To enable NVT developers to add tags to their NVTs and define new properties
without extensive changes to the OpenVAS codebase.
</p>

<h3>References</h3>

<p>
</p>

<h3>Rationale</h3>

<p>
Currently, a number of commands are used to set the individual properties of an
NVT, e.g. script_cve_id, script_bugtraq_id, script_family and so on. These
commands set the value of certain fixed-length fields in the NVT structure.
</p>

<p>
This approach is very inflexible; in order to make even small changes to a
property setting command or to add a new one, a lot of code has to be changed in
a number of spaces as well as (possibly) protocol specifications.
</p>

<p>
This change request proposes to add a script_tag command which would complement
the existing property setting commands. The parameters for the script_tag
command would consist of a property name and a list of values for this property
as in the following example:
</p>

<pre>
script_tag(name:"cvss", value:"6.8");
script_tag(name:"cvss_base", value:"(AV:N/AC:L/Au:N/C:N/I:N/A:P)");
script_tag(name:"risk_factor", value:"high");
</pre>

<p>
By adding support for script_tags to OTP and the OpenVAS-Client, it could be
possible for users to define their own sorting scheme apart from the current
scheme of sorting NVTs by family.
</p>

<h3>Effects</h3>

<p>
This would allow script authors to easily add new properties and to extend
existing properties without extensive knowledge of the inner workings of
openvas-libnasl and openvas-libraries.
</p>

<h3>Design and Implementation</h3>

<p>
Adding script_tag would require changes in openvas-libraries and openvas-libnasl
as well as changes to the NVT data structure and the OTP protocol specification.
Initially, the script_tag command would be modeled close to the existing
script_xref command and thus require only minor changes in openvas-libraries,
openvas-libnasl and openvas-server.
</p>

<p>
Proper support for tags would likely lead to a considerable amount of changes in
the client GUI; initials support will most likely consist of simply displaying the
tags of individual NVTs in their information dialog.
</p>

<p>
The active NASL developers should agree on a core set of tags to standardize the
tags in use. This core set will be documented in the OpenVAS compendium and a QA
script will be generated to check the NVTs for uses of non-standard tags.
</p>

<h3>History</h3>

<ul>
<li> 2008-12-29 Michael Wiegand &lt;michael.wiegand@intevation.de&gt;:<br>
     Updated status and usage.</li>
<li> 2008-12-03 Michael Wiegand &lt;michael.wiegand@intevation.de&gt;:<br>
     Updated status.</li>
<li> 2008-11-28 Michael Wiegand &lt;michael.wiegand@intevation.de&gt;:<br>
     Initial text.</li>
</ul>
