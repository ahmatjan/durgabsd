m4_dnl -*-html-*-
m4_include(`template.m4')

m4_dnl OpenVAS
m4_dnl $Id$
m4_dnl Description: OpenVAS Change Request #54 (Improve SSH Support)
m4_dnl
m4_dnl Authors:
m4_dnl Michael Wiegand <michael.wiegand@greenbone.net>
m4_dnl
m4_dnl Copyright:
m4_dnl Copyright (C) 2011 Greenbone Networks GmbH
m4_dnl
m4_dnl This program is free software; you can redistribute it and/or
m4_dnl modify it under the terms of the GNU General Public License
m4_dnl as published by the Free Software Foundation; either version 2
m4_dnl of the License, or (at your option) any later version.
m4_dnl
m4_dnl This program is distributed in the hope that it will be useful,
m4_dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
m4_dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
m4_dnl GNU General Public License for more details.
m4_dnl
m4_dnl You should have received a copy of the GNU General Public License
m4_dnl along with this program; if not, write to the Free Software
m4_dnl Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.

m4_define(`EN')
m4_define(`TITLE', `OpenVAS')
m4_define(`MAIN', `misc')



PAGE_START
<h2>OpenVAS Change Request #54: Improve SSH Support</h2>

<p>
Status: Voted +4. In progress.
</p>

<h3>References</h3>

<ul>
  <li>
  <a href="http://lists.wald.intevation.org/pipermail/openvas-devel/2011-May/002637.html">Discussion
    of this Change Request on openvas-devel</a></li>
</ul>

<h3>Purpose</h3>

<p>
Improve SSH support in OpenVAS Libraries by using a library.
</p>

<h3>Rationale</h3>

<p>
The current support for SSH connections in OpenVAS is split between OpenVAS
Libraries, which supplies basic cryptographic functions with the help of the
GnuTLS library, and NASL libraries like ssh_func.inc, which provide
functionality for establishing an SSH connection through a network socket.
</p>

<p>
This implementation has a number of drawbacks:
</p>

<ul>
  <li>The fragmentation between OpenVAS Libraries and the support code in NASL
  makes this solution difficult to maintain. Fixing errors or adding new
  functionality requires a deep understanding of the current implementation and
  of the SSH protocol itself.</li>
  <li>The current implementation is severely limited and provides only one
  encryption algorithm (Blowfish) and only one MAC algorithm (SHA1). If a remote
  SSH host does not support this exact combination, no SSH connection is
  possible.</li>
  <li>There are a number of issue with the current implementation which limit
  functionality in other ways, for example public keys having to be PKCS #8
  encoded, certain passphrases not working or incompatibilities with recent
  GnuTLS versions. Fixing these issues in the current implementation is not
  practical for some issues and would require large amounts of work for
  others.</li>
</ul>

<p>
This change request proposes establishing an alternative SSH functionality which
will be compatible with the current implementation for an NVT point of view and
will ultimately replace the current implementation.
</p>

<p>
The most promising approach for gaining an alternative SSH functionality is
using an existing well-maintained library. Early tests with <a
  href="http://www.libssh2.org/">libssh2</a> have shown good results.
</p>

<h3>Effects</h3>

<p>
A major effect of this change would be a increase in compatibility with SSH
targets and more reliable SSH functionality.
</p>

<p>
A side effect would be adding one more dependency to OpenVAS Libraries and a
future loss of functionality for systems not able to provide this dependency.
However, the current versions of all major GNU/Linux distributions provide this
dependency.
</p>

<h3>Design and Implementation</h3>

<p>
A first step will be adding a new set of NASL commands which access the SSH
functionality provided by the SSH library instead of using the current
implementation. NVTs can then decide on the NASL level which implementation they
wish to use.
</p>

<h3>History</h3>

<ul>
  <li> 2011-05-30 Michael Wiegand &lt;michael.wiegand at greenbone dot net&gt;:<br/>
    Updated status with voting results.
  </li>
  <li> 2011-05-02 Michael Wiegand &lt;michael.wiegand at greenbone dot net&gt;:<br/>
    Initial text.
  </li>
</ul>
