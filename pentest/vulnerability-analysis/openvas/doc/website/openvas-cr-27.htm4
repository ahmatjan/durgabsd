m4_dnl -*-html-*-
m4_include(`template.m4')

m4_dnl OpenVAS
m4_dnl $Id$
m4_dnl Description: OpenVAS Change Request #27
m4_dnl
m4_dnl Authors:
m4_dnl Stjepan Gros <sgros.ml@gmail.com>
m4_dnl
m4_dnl Copyright:
m4_dnl Copyright (C) 2009 Stjepan Gros
m4_dnl
m4_dnl This program is free software; you can redistribute it and/or modify
m4_dnl it under the terms of the GNU General Public License version 2,
m4_dnl or, at your option, any later version as published by the Free
m4_dnl Software Foundation
m4_dnl
m4_dnl This program is distributed in the hope that it will be useful,
m4_dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
m4_dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
m4_dnl GNU General Public License for more details.
m4_dnl
m4_dnl You should have received a copy of the GNU General Public License
m4_dnl along with this program; if not, write to the Free Software
m4_dnl Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.

m4_define(`EN')
m4_define(`TITLE', `OpenVAS')
m4_define(`MAIN', `misc')



PAGE_START
<h2>OpenVAS Change Request #27: IPv6 support</h2>

<p>
Votes: +10. Done. Released with openvas-libraries and openvas-scanner 3.0.0.
</p>

<h3>Purpose</h3>

<p>
To introduce IPv6 support into OpenVAS
</p>

<h3>References</h3>

<p>
<a href="http://lists.wald.intevation.org/pipermail/openvas-devel/2008-December/001237.html">IPv6 and a text about OpenVAS on InternetNews</a>
</p>

<h3>Rationale</h3>

<p>
In the current version, OpenVAS only supports IPv4 protocol. This is now
a dominant protocol on the Internet. The problems with IPv4 are long
known, e.g. shortage of addresses, and a subset of those problems is expected
to be solved by a new protocol, IPv6. IPv6 is now supported on all the
major operating systems, network devices and in the applications and
the IPv6 deployment is growing steadily but certainly. This means that
the OpenVAS, in order to stay viable solution for the security testings,
has to be extended to support IPv6.
</p>

<p>
More specifically, supporting IPv6 in OpenVAS means at least the following:
</p>

<p>
<ol>
<li>It means that you can enter IPv6 address(es) in the OpenVAS client
    and then those hosts, whith those addresses, are scanned.</li>

<li>It means that when you enter hostname (or FQDN) which resolves to
    IPv6 address, this address will be used</li>
</ol>
</p>

<h3>Effects</h3>

<p>
The code changes will not impact any existing functionality. They
will allow existing checks to be used over the IPv6 network. Additionally,
it will be possible to write new tests specialized for IPv6 weaknesses.
</p>

<h3>Design and Implementation</h3>

<p>
The following changes will be necessary:
</p>

<p>
<ul>
<li>Much of the core socket functions used currently in OpenVAS
    are specific to IPv4 and they have to be changed.</li>
<li>There is a code in OpenVAS for forging IP packets. This code has to
    be enhanced to know how to construct IPv6 packets.</li>
<li>NASL laguage has to be enhanced to accept IPv6 addresses, and
    potentially IPv6 specific extensions.</li>
</ul>
</p>

<p>
Specifically, the following modules will undergo changes,
<ul>
<li>
<b>openvas-libnasl:</b>
<pre>
- capture_packet.c - Used by packet forgery
- nasl_packet_forgery.c - all functions need to be changed and additional
  functions for IPv6
- nasl.c - command line tool
- nasl_host.c  - deals with remote host
- nasl_socket.c
- The include files structures
</pre>
</li>

<li>
<b>openvas-libraries:</b>
<pre>
- ids_send.c - IDS evasion techniques
- network.c
- pcap.c
- resolve.c
- www_funcs.c
- Host Gatherer module
</pre>
</li>
<li>
<b>openvas-server:</b>
<pre>
- openvasd.c
</pre>
</li>

<li>
<b>openvas-client:</b>
<pre>
- network.c
- system.c
- resolv.c
The above modules are a copy of modules in openvas-library, changes will be
common.

Additionally openvas-client has the following modules that would need changes,
- prefs_dialog modules to validate various user inputs
- nessus.c
- parser.c
- attack.c
</pre>
</li>
</ul>
</p>

<p>
The proposed development steps are:
</p>

<p>
<ol>
<li>Phase I:
    Allow IPv6 addresses to be entered by the user, even though
    they are not used, i.e. when user enters IPv6 the address is
    ignored with appropriate warning or error message.</li>
<li>Phase II:
    Refactor the current IPv4 specific code into separate module
    and/or functions.</li>
<li>Phase III:
    Then, in the next step this code is extended so that it transparently
    supports IPv6 in addition to IPv4.</li>
<li>Phase IV:
    Add the code to handle raw IPv6 packets.</li>
<li>
    Phase V:
    Update the OpenVAS compendium documenting the IPv6 support and design
    overview
</li>
</ol>
</p>

<h3>History</h3>

<ul>
<li> 2009-01-06 Stjepan Gros &lt;sgros.ml@gmail.com&gt;:<br>
     Initial text.</li>
<li> 2009-01-08 Chandrashekhar B &lt;bchandra@secpod.com&gt;:<br>
     Updated module level details.</li>
<li> 2009-01-13 Chandrashekhar B &lt;bchandra@secpod.com&gt;:<br>
     Updated openvas-client modules</li>
<li> 2010-01-06 Felix Wolfsteller &lt;felix.wolfsteller@intevation.de&gt;:<br>
     Updated status as done.</li>
</ul>
