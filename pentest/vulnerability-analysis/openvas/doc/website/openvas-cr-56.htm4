m4_dnl -*-html-*-
m4_include(`template.m4')

m4_dnl OpenVAS
m4_dnl $Id$
m4_dnl Description: OpenVAS Change Request #56 (NVT Feed Improvements)
m4_dnl
m4_dnl Authors:
m4_dnl Jan-Oliver Wagner <jan-oliver.wagner@greenbone.net>
m4_dnl
m4_dnl Copyright:
m4_dnl Copyright (C) 2011 Greenbone Networks GmbH
m4_dnl
m4_dnl This program is free software; you can redistribute it and/or
m4_dnl modify it under the terms of the GNU General Public License
m4_dnl as published by the Free Software Foundation; either version 2
m4_dnl of the License, or (at your option) any later version.
m4_dnl
m4_dnl This program is distributed in the hope that it will be useful,
m4_dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
m4_dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
m4_dnl GNU General Public License for more details.
m4_dnl
m4_dnl You should have received a copy of the GNU General Public License
m4_dnl along with this program; if not, write to the Free Software
m4_dnl Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.

m4_define(`EN')
m4_define(`TITLE', `OpenVAS')
m4_define(`MAIN', `misc')

PAGE_START
<h2>OpenVAS Change Request #56: NVT Feed Meta Data Improvements</h2>

<p>
Status: Voted +6. Done.
</p>

<h3>References</h3>

<ul>
  <li>
    <a href="http://lists.wald.intevation.org/pipermail/openvas-plugins/2011-October/000687.html">
    Some initial discussion about additional tags for NVTs on openvas-plugins</a>
  </li>
</ul>

<h3>Purpose</h3>

<p>
Provide more helpful meta information about NVTs and reduce some
redundant information.
</p>

<h3>Rationale</h3>

<p>
This change request intends the following modifications to
any NVT present in the Feed:
</p>

<ul>

<li> <p> Fix Version information: This has been neglected in the past
         though agreed already.
</li> </p>

<li> <p> Add creation and last modification timestamps as meta information:
         Several users asked for this to better judge how old the test
         routine is. This is analog to for example the CVE information
         where both timestamps are always available.
</li> </p>

<li> <p> Remove "Risk factor: xxx" text element from description part:
         Since all NVTs have a tag "risk_factor" for some time, the
         information in the text is redundant. The tag information is
         easier to handle for selection/classification operations than
         the description text.
     <p> In fact the "risk_factor" tag is a transformation from the CVSS
         and is itself redundant once any NVT is tagged with a CVSS. It is
         not determined when this will have happened though. Removing
         the risk factor from the text at least reduces redundancy.
     </p>
</li> </p>

</ul>


<h3>Effects</h3>

<p>
OpenVAS tool chain can rely on presence of a version number for any NVT.
</p>

<p>
OpenVAS tool chain can rely on presence of creation and last modification
timestamps.
</p>

<p>
More tags will appear in the meta data of NVTs, so automatically generated
dialogs for the NVT meta information might grow in size.
</p>

<p>
The memory footprint might grow with the additional tags. The shortened
description texts might balance this a little bit, but likely not
entirely.
</p>

<p>
Old processing chains that rely on the presence of the
risk factor inside the description text will fail.
No such processing chains are known, though.
</p>

<h3>Design and Implementation</h3>

<p>
Version tag:
The SVN "Revision" tag is used for the version.
Therefore the script files need to be prepared for this for SVN
and the script_version() command in the NVTs must be present and
contain the correct "Revision" SVN tag. Henri Doreau already started
to fix various scripts. This activity can be continued in conjunction
with the other changes.
</p>

<p>
Creation time stamp and last modification time stamp:
This information can be pulled from SVN. A couple of thousand
NVTs are older than the SVN history. So these will all get the
time stamp of starting the SVN repository.
For some it might possible to derive at least the year from copyright
or CVEs, but this not systematically and reliably possible. Perhaps it
is better to stick with the rule that the OpenVAS NVT feed started at
a specific date. Thomas Reinke offered some information from his own repository
about the creation timestamps. However, it is to be decided whether to
undertake the effort to merge the timestamp or whether to simply use what
SVN offers (consistently).
</p>

<p>
For new scripts, the creation date can be generated using the
<code>date</code> command:<br/>
<code>LC_ALL=C date +"%F %T %z (%a, %d %b %Y)"</code>
</p>

<p>
The last modification date and the last revision number can be set
automatically by SVN. The following fields must be provided as is:<br/>
<code>
script_version("$Revision$");<br/>
script_tag(name:"last_modification", value:"$Date$");
</code>
</p>

<p>
With the SVN keywords "Revision" and "Date" set for new scripts:<br/>
<code>svn propset svn:keywords 'Revision Date' &lt;filename&gt;</code>
</p>

<p>
Removal of "Risk factor" from description:
This should be possible
mostly automatically by text pattern matching. It should be taken
care that unneeded newlines are then also removed.
</p>

<h3>History</h3>

<ul>
  <li> 2011-11-10 Henri Doreau &lt;henri.doreau at greenbone dot net&gt;:<br/>
    Updated status.
  </li>
  <li> 2011-11-03 Henri Doreau &lt;henri.doreau at greenbone dot net&gt;:<br/>
    Added implementation details.
  </li>
  <li> 2011-10-31 Henri Doreau &lt;henri.doreau at greenbone dot net&gt;:<br/>
    Updated status.
  </li>
  <li> 2011-10-25 Jan-Oliver Wagner &lt;jan-oliver.wagner at greenbone dot net&gt;:<br/>
    Initial text.
  </li>
</ul>
