m4_dnl -*-html-*-
m4_include(`template.m4')

m4_dnl OpenVAS
m4_dnl $Id$
m4_dnl Description: How to use SLAD
m4_dnl
m4_dnl Authors:
m4_dnl Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>
m4_dnl
m4_dnl Copyright:
m4_dnl Copyright (C) 2008 Intevation GmbH
m4_dnl
m4_dnl This program is free software; you can redistribute it and/or
m4_dnl modify it under the terms of the GNU General Public License
m4_dnl as published by the Free Software Foundation; either version 2
m4_dnl of the License, or (at your option) any later version.
m4_dnl
m4_dnl This program is distributed in the hope that it will be useful,
m4_dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
m4_dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
m4_dnl GNU General Public License for more details.
m4_dnl
m4_dnl You should have received a copy of the GNU General Public License
m4_dnl along with this program; if not, write to the Free Software
m4_dnl Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.

m4_define(`EN')
m4_define(`TITLE', `OpenVAS')
m4_define(`MAIN', `misc')



PAGE_START
<h2>How to use Security Local Auditing Daemon (SLAD) with OpenVAS</h2>

<p>
Homepage: <a href="http://www.dn-systems.org/projects/slad/">http://www.dn-systems.org/projects/slad/</a>
</p>

<p>
This description is a quick guide how you get first results with SLAD
via OpenVAS. For real production mode you should make yourself familiar
with the details of SLAD and its integrated tools.
There is also the <a href="http://www.dn-systems.org/projects/slad/slad-dev-and-admin-guide.pdf">SLAD developer's and administrator's guide as PDF file</a>.
</p>

<p>
Please note that the OpenVAS "stable" branch &mdash; the 1.0.x series &mdash; is
the recommended version for using SLAD in OpenVAS. Due to the changes necessary
for the upcoming 2.0 release, versions from the 2.0-beta branch may not work with
SLAD until the beta phase has come to an end.
</p>

<ol>
<li> Download SLADinstaller. The latest version of SLADinstaller is available
     in the <a href="http://wald.intevation.org/frs/?group_id=29">OpenVAS file
     repository</a>.

<li> Compile SLADinstaller by typing "make", which works at least on a Debian
     GNU/Linux "Etch" 4.0. There is a file "INSTALL" which might provide
     some helpful hints.

<li> Prepare SSH Authorization:<br>
     You have to use an SSH key created following <a href="performing_lsc.html">
     the example for ssh-keygen and openssl on the page about local security
     checks</a>. Make sure that you create an RSA .p8 key file since the keys
     auto-generated by SLADinstaller are not usable with OpenVAS at the moment
     due to internal changes in OpenVAS.

<li> Ensure SLAD is not yet installed yet on your target system. You can remove
     an existing SLAD installation by using the following command:

<pre># /opt/slad/bin/slad-uninstall.sh</pre>

<li> Run SLADinstaller by executing the "sladinstaller" binary and fill out the
     entries. Remember that you have to use the SSH key you have just created
     yourself and not let sladinstaller create one for you as keys
     auto-generated by SLADinstaller will not work. Hostname defines the target
     system.

<li> It might be necessary for you to adjust the sshd configuration of the
     target system to enable SLADinstaller to log in. In this case,
     SLADinstaller will provide you with instructions on how to do this.

<li> Now you need to create the "slad.inc" file (which contains settings
     specific to your SLAD installation) and copy it onto your OpenVAS Scanner.
     You can create the file on the system where you installed SLAD using the
     following commands:

<pre>
 # cd /opt/slad/share/nessus_plugins/
 # /opt/slad/bin/sladd -s plugins | awk -f sladbuild.awk > slad.inc
</pre>

     The "slad.inc" file has to be copied into your NVT directory. If you
     compiled your OpenVAS installation from source and without any prefix, you
     will find this directory under /usr/local/lib/openvas/plugins. Please note
     that the location of this directory may differ depending on your
     installation method and your distribution.

<li> Finally, run OpenVAS-Client and configure your task to scan the target
     machine where you installed SLAD and enable the NVTs "SLAD init" and "SLAD run".<br><br>
     Do not forget to set the preferences for "SLAD init". Remember to use the
     RSA .p8 key you created above in the "SLAD init" preferences field when
     asked for the "slad SSH private key". Also note that your "slad SSH key
     passphrase" is the passphrase you used when creating the RSA .p8 and not
     the one you used whe generating your SSH key.<br><br>
     You may use the "SLAD run" preferences section to configure the individual
     SLAD plugins.<br><br>
     A first scan will schedule the tasks; use the NVT "SLAD fetch results" to
     retrieve the results from the target host that were collected so far.
     Please note that the time needed for execution varies among the SLAD
     plugins (e.g. lsof is fast, John-the-ripper might take very long) and some
     results may not be available the first time you run "SLAD fetch results".
     Subsequent scans with "SLAD fetch results" enabled will fetch the remaining
     results.
</ol>
