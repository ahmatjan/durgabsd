m4_dnl -*-html-*-
m4_include(`template.m4')

m4_dnl OpenVAS
m4_dnl $Id$
m4_dnl Description: Howto for doing local security checks with OpenVAS.
m4_dnl
m4_dnl Authors:
m4_dnl Jan-Oliver Wagner <jan-oliver.wagner@intevation.de>
m4_dnl
m4_dnl Copyright:
m4_dnl Copyright (C) 2007 Intevation GmbH
m4_dnl
m4_dnl This program is free software; you can redistribute it and/or
m4_dnl modify it under the terms of the GNU General Public License
m4_dnl as published by the Free Software Foundation; either version 2
m4_dnl of the License, or (at your option) any later version.
m4_dnl
m4_dnl This program is distributed in the hope that it will be useful,
m4_dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
m4_dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
m4_dnl GNU General Public License for more details.
m4_dnl
m4_dnl You should have received a copy of the GNU General Public License
m4_dnl along with this program; if not, write to the Free Software
m4_dnl Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.

m4_define(`EN')
m4_define(`TITLE', `OpenVAS')
m4_define(`MAIN', `misc')


PAGE_START

<h2>Howto: Perform local security checks</h2>

<p>
This text explains how to run local security checks with OpenVAS.
</p>

<h3>Create users for local security checks</h3>

<p>First, you need a key with certificate:</p>

<pre>
$ ssh-keygen -t rsa -f ~/.ssh/id_rsa_sshovas
</pre>

<p>Now, for each target system:</p>

<pre>
# adduser --disabled-password sshovas
  Name: OpenVAS Local Security Checks
# su - sshovas
$ mkdir .ssh
$ cp /some/path/id_rsa_sshovas.pub .ssh/authorized_keys
$ chmod 500 .ssh
$ chmod 400 .ssh/authorized_keys
</pre>

<h3>Configure the local security checks in OpenVAS-Clients</h3>

<p>
In Preferences, configure SSH Authorization:
</p>

<pre>
SSH login name: sshovas
SSH private key: ~/.ssh/sshovas_rsa
SSH key passphrase: ********
SSH public key: ssh/id_rsa_sshovas.pub
</pre>

<p>Note: It is actually not necessary to submit the public key,
but currently this is necessary due to a bug inherited from Nessus.</p>

<p>Next, make sure you select at least these NVTs:</p>

<pre>
Debian Local Security Checks/*
Misc/Determine List of installed packages via SSH login
Service Detection/Services
Settings/Global variable settings
Settings/SSH Authorization
</pre>

<p>or ensure dependencies are resolved at runtime (see checkboxes)
if you select only some local security checks.</p>
