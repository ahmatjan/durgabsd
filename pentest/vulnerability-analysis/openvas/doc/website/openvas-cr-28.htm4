m4_dnl -*-html-*-
m4_include(`template.m4')

m4_dnl OpenVAS
m4_dnl $Id$
m4_dnl Description: OpenVAS Change Request #28
m4_dnl
m4_dnl Authors:
m4_dnl Michael Wiegand <michael.wiegand@intevation.de>
m4_dnl
m4_dnl Copyright:
m4_dnl Copyright (C) 2009 Intevation GmbH
m4_dnl
m4_dnl This program is free software; you can redistribute it and/or
m4_dnl modify it under the terms of the GNU General Public License
m4_dnl as published by the Free Software Foundation; either version 2
m4_dnl of the License, or (at your option) any later version.
m4_dnl
m4_dnl This program is distributed in the hope that it will be useful,
m4_dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
m4_dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
m4_dnl GNU General Public License for more details.
m4_dnl
m4_dnl You should have received a copy of the GNU General Public License
m4_dnl along with this program; if not, write to the Free Software
m4_dnl Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.

m4_define(`EN')
m4_define(`TITLE', `OpenVAS')
m4_define(`MAIN', `misc')



PAGE_START
<h2>OpenVAS Change Request #28: OpenVAS Management Protocol (OMP)</h2>

<p>
Status: Voted +8. Released with openvas-manager 1.0.0.
</p>

<p>
For the final specification of OMP please refer to this page:
<a href="protocol-doc.html">Protocol Documentation</a>.
</p>

<h3>Purpose</h3>

<p>
To introduce a new protocol for the communication between OpenVAS client and
server applications that finally does drop the design flaws of NTP/OTP.
</p>

<p>
To allow for consistent, privilege-separating server-side management of user
data like tasks, reports etc.
</p>

<p>
To allow for easy HTTP/XML-based implementations.
</p>

<h3>References</h3>

<p>
(none)
</p>

<h3>Rationale</h3>

<p>
The OpenVAS server and client use the OpenVAS Transfer Protocol (OTP) for
communication. OTP is a descendant of the Nessus Transfer Protocol (NTP).
OTP cleaned up unused, dangerous and inconsistent elements from NTP
and introduced some small helpful extra-features, but it still inherited
various design weaknesses of NTP such as broken escaping, newlines etc.
OMP aims to implement existing functionality in a clean and modern manner
and to be open for future improvements.
</p>

<p>
The design goals for this new protocol should be:
</p>

<ul>
  <li>
    Allow for easy and fast parsing of the protocol while retaining
    human-readability for debugging and development purposes.
  </li>
  <li>
    Make the protocol as stateless as possible to avoid unnecessary delays in
    the communication process.
  </li>
  <li>
    Allow for easy integration into other protocols and communication channels.
  </li>
</ul>

<p>
This change request proposes an XML based approach to satisfy the goals
described above. A first draft of the proposed protocol is available
in the section "Design and Implementation" of this Change Request.
</p>

<h3>Effects</h3>

<p>
Client and server elements need to be provided with the ability
to communicate via OMP. On the OpenVAS-Client-side this can be done
by offering OMP as an alternative protocol and thus OpenVAS-Client
will remain compatible with OTP servers.
</p>

<p>
It will be possible to develop "light" clients without local storage
because OMP offers to store user data.
</p>

<p>
The server side will need a comprehensive re-design to allow for the features
of OMP, namely the user data. For transistion phase it is fairly simple
to translate OMP into OTP which essentially means that it is possible to leave
openvasd untouched and place a OMP layer between clients and openvasd.
Consequently, OTP will always be available as a fall back and thus
users are not confronted with a mandatory change of concept, they can decide
on their own.
</p>

<h3>Design and Implementation</h3>

<p>
The main implementation strategy is to implement a new layer between openvasd
and the clients as "openvas-manager" which uses OMP to communicate with the
clients, stores user data and communicates via OTP with openvasd. based on
this, OpenVAS-Client can be provided with OMP abilities additional to OTP.
Eventually openvasd can be drastically minimized to do the core job only and
thus allow for privilege separation.
</p>

<h4>Protocol Design</h4>

<p>
The OpenVAS Management Protocol is intended for use between OpenVAS clients
and an OpenVAS manager component.
</p>

<p>
The current specification proposes an XML based approach. This is intended to
allow for easy integration into other XML capable protocols and communication
methods, e.g. Web Services/SOAP, XmlHttpRequest, REST or other methods of
invoking remote functionality.
</p>

<p>
One design consideration is to keep the actual syntax adaptable for different
communication technologies. The present specification assumes a simple XML-based
communication protocol. Possible alternatives are implementations of the OMP
functionality using the very same keywords e.g. based on HTTP GET/POST
technology.  Thus, any implementation of OMP should keep the actual
communication technology separate from the implementation of the semantic
functionality.
</p>

<p>
Human-readable strings are encoded as UTF-8.
</p>

<p>
Files or other binary data is expected to be Base64 encoded.
</p>

<p>
The OMP communication between a client and the manager takes a simple command
response form.  The client sends a command, a single XML element, to the
manager.  The manager responds with a single XML element.
</p>

<p>
There is a predefined set of OMP commands, each of which is described
<a href="#command_summary">below</a>.
</p>

<p>
For a client, using OMP centers around creating and manipulating resources.
The key resource is the task.  A task defines a network vulnerability scan.
The scan can be performed by running the task, for example with the start_task
command.  A task is created with the create_task command by combining at least
two of the other resources: a config and a target.
</p>

<h5>Numerical response codes</h5>

<p>
The OpenVAS manager uses numerical response codes to indicate whether a command
issued by the client could be executed successfully. The response codes are
very similar to the response codes used by HTTP as specified in <a
href="http://www.ietf.org/rfc/rfc2616.txt">RFC 2616</a>; a response code in the
2xx range indicates that the command has been successfully received, understood,
and accepted. A response code in the 4xx range indicates that the command issued
could not be executed due to error made by the client. A response in the 5xx
range indicates that an error occurred in the manager during the processing of
this command.<br>
Responses are expected to include helpful information whenever possible, like
the ID of the resulting report when a task is started.<br>
Implementations which transfer OMP using a response-code aware protocol (e.g.
HTTP) might want to consider including this status code in the message generated
by this protocol.
</p>

<h5>Unique ID scheme</h5>

<p>
The protocol uses random UUIDs as described in <a
href="http://www.ietf.org/rfc/rfc4122.txt">RFC 4122</a>.
</p>

<h5>Authentication</h5>

<p>
The client is expected to execute an authentication command at the beginning of
each connection.  The only commands that can precede authentication are
<a href="#get_version">get_version</a> and <a href="#commands">commands</a>.
The authenticate command looks like the following:
<pre>
&lt;authentication&gt;
  &lt;credentials&gt;
    &lt;username&gt;FooBar&lt;/username&gt;
    &lt;password&gt;276LkeFHJWnCaD6ynSlP6mnf9&lt;/password&gt;
  &lt;/credentials&gt;
&lt;/authentication&gt;
</pre>
In future version of the protocol, other types of credentials are to be expected.
If the credentials supplied by the client are not sufficient, the manager must
reply with:
<pre>
&lt;authentication_response status="400" status_text="Authentication failed" /&gt;
</pre>
</p>

<h4 id="command_summary">Summary of Protocol Primitives / Commands</h4>

<table id="index">
<tr id="index">
  <td id="index"><a href="#authenticate">authenticate</a></td>
  <td id="index">Authenticate with the manager.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#commands">commands</a></td>
  <td id="index">Execute a list of OMP commands.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#create_agent">create_agent</a></td>
  <td id="index">Create an agent.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#create_config">create_config</a></td>
  <td id="index">Create a scan configuration.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#create_escalator">create_escalator</a></td>
  <td id="index">Create an escalator.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#create_lsc_credential">create_lsc_credential</a></td>
  <td id="index">Create a local security check credential.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#create_note">create_note</a></td>
  <td id="index">Create a note.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#create_override">create_override</a></td>
  <td id="index">Create an override.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#create_schedule">create_schedule</a></td>
  <td id="index">Create a schedule.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#create_target">create_target</a></td>
  <td id="index">Create a target.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#create_task">create_task</a></td>
  <td id="index">Create a new task.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#delete_agent">delete_agent</a></td>
  <td id="index">Delete an agent.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#delete_config">delete_config</a></td>
  <td id="index">Delete a config.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#delete_escalator">delete_escalator</a></td>
  <td id="index">Delete an escalator.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#delete_lsc_credential">delete_lsc_credential</a></td>
  <td id="index">Delete a local security check credential.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#delete_note">delete_note</a></td>
  <td id="index">Delete a note.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#delete_override">delete_override</a></td>
  <td id="index">Delete an override.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#delete_report">delete_report</a></td>
  <td id="index">Delete an existing report.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#delete_schedule">delete_schedule</a></td>
  <td id="index">Delete a schedule.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#delete_target">delete_target</a></td>
  <td id="index">Delete a target.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#delete_task">delete_task</a></td>
  <td id="index">Delete an existing task.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_agents">get_agents</a></td>
  <td id="index">Get all agents.</td>
</tr>
m4_dnl <tr id="index">
m4_dnl   <td id="index"><a href="#get_certificates">get_certificates</a></td>
m4_dnl   <td id="index">Get all available certificates.</td>
m4_dnl </tr>
<tr id="index">
  <td id="index"><a href="#get_configs">get_configs</a></td>
  <td id="index">Get all configs.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_dependencies">get_dependencies</a></td>
  <td id="index">Get dependencies for all available NVTs.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_escalators">get_escalators</a></td>
  <td id="index">Get all escalators.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_lsc_credentials">get_lsc_credentials</a></td>
  <td id="index">Get all local security check credentials.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_notes">get_notes</a></td>
  <td id="index">Get all notes.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_nvts">get_nvts</a></td>
  <td id="index">Get all available NVTs.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_nvt_families">get_nvt_families</a></td>
  <td id="index">Get a list of all NVT families.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_nvt_feed_checksum">get_nvt_feed_checksum</a></td>
  <td id="index">Get checksum for entire NVT collection.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_overrides">get_overrides</a></td>
  <td id="index">Get all overrides.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_preferences">get_preferences</a></td>
  <td id="index">Get preferences for all available NVTs.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_reports">get_reports</a></td>
  <td id="index">Get all reports.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_results">get_results</a></td>
  <td id="index">Get results.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_schedules">get_schedules</a></td>
  <td id="index">Get all schedules.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_system_reports">get_system_reports</a></td>
  <td id="index">Get all system reports.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_target_locators">get_target_locators</a></td>
  <td id="index">Get configured target locators.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_targets">get_targets</a></td>
  <td id="index">Get all targets.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_tasks">get_tasks</a></td>
  <td id="index">Get task status information.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#get_version">get_version</a></td>
  <td id="index">Get the OpenVAS Manager Protocol version.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#help">help</a></td>
  <td id="index">Get the help text.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#modify_config">modify_config</a></td>
  <td id="index">Update an existing config.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#modify_note">modify_note</a></td>
  <td id="index">Modify an existing note.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#modify_override">modify_override</a></td>
  <td id="index">Modify an existing override.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#modify_report">modify_report</a></td>
  <td id="index">Modify an existing report.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#modify_task">modify_task</a></td>
  <td id="index">Update an existing task.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#pause_task">pause_task</a></td>
  <td id="index">Pause a running task.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#resume_or_start_task">resume_or_start_task</a></td>
  <td id="index">Resume task if stopped, else start task.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#resume_paused_task">resume_paused_task</a></td>
  <td id="index">Resume a paused task.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#resume_stopped_task">resume_stopped_task</a></td>
  <td id="index">Resume a stopped task.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#start_task">start_task</a></td>
  <td id="index">Manually start an existing task.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#stop_task">stop_task</a></td>
  <td id="index">Stop a running task.</td>
</tr>
<tr id="index">
  <td id="index"><a href="#test_escalator">test_escalator</a></td>
  <td id="index">Run an escalator.</td>
</tr>
</table>

<h4>Details of Protocol Primitives / Commands</h4>

<h4 id="authenticate">authenticate</h4>

<p>
The client uses the authenticate command to authenticate with the manager.
</p>

<p>
Command elements:
<ul>
  <li>
    &lt;credentials&gt;
    <ul>
      <li>&lt;username&gt; is the login name of the user.</li>
      <li>&lt;password&gt; is the user's password.</li>
    </ul>
  </li>
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;authenticate&gt;
  &lt;credentials&gt;
    &lt;username&gt;sally&lt;/username&gt;
    &lt;password&gt;secret&lt;/password&gt;
  &lt;/credentials&gt;
&lt;/authenticate&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;authenticate_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;authenticate_response status="400" status_text="Authenticate failed" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;authenticate_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="commands">commands</h4>

<p>
The client uses the commands command to run a list of commands.  The elements
are executed as OMP commands in the given sequence.  The reply contains the
result of each command, in the same order as the given commands.
</p>

<p>
Command elements:
<ul>
  <li>Any OMP command.
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;commands&gt;
  &lt;create_task&gt;
    &lt;rcfile&gt;asdf3235saf3kjBVF...&lt;/rcfile&gt;
    &lt;name&gt;Scan Webserver&lt;/name&gt;
    &lt;comment&gt;Hourly scan of the webserver&lt;/comment&gt;
  &lt;/create_task&gt;
&lt;/commands&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;commands_response status="200" status_text="OK"&gt;
  &lt;create_task_response status="201" status_text="OK, resource created" id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6" /&gt;
&lt;/commands_response&gt;
</pre>

<h4 id="create_agent">create_agent</h4>

<p>
The client uses the create_agent command to create a new agent. This command must
include an installer for the agent and an human-readable
identifier assigned by the user.  The command may include a comment, an install
HOWTO and a user HOWTO.  The installer may include a signature.
</p>

<p>
If there was no error with the command sent by the client, the manager will
assign a unique ID to the agent and include this ID in
its reply to the client.
</p>

<p>
Command elements:
<ul>
  <li>
    &lt;installer&gt; is a file that installs the agent on a target machine.
    The file must be Base64 encoded.
    <ul>
      <li>
        &lt;signature&gt; is a detached OpenPGP signature of the installer.</li>
      </li>
    </ul>
  <li>&lt;name&gt; is a human-readable identifier.
  <li>&lt;comment&gt; is a human-readable text.
  <li>&lt;howto_install&gt; is a file describing how to install the agent.
      The file must be Base64 encoded.
  <li>&lt;howto_use&gt; is a file describing how to use the agent.
      The file must be Base64 encoded.
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;create_agent&gt;
  &lt;installer&gt;
    asdf3235saf3kjBVF...
    &lt;signature&gt;iEYEABECAAYFA...&lt;/signature&gt;
  &lt;/installer&gt;
  &lt;name&gt;SLAD&lt;/name&gt;
&lt;/create_agent&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_agent_response status="201" status_text="OK, resource created" id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_agent_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_agent_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="create_config">create_config</h4>

<p>
The client uses the create_config command to create a new config. This command can
be called in three ways:
  <ul>
    <li>
      With a copy element.  The text of the element must be the ID of an
      existing config.  In this case a name element is required.  The new
      config is a copy of the existing config, with the given name.
    </li>
    <li>
      With an embedded <a href="#get_configs">get_configs</a> response element.
      The config is created as described in the element.
    </li>
    <li>
      With an rcfile element.  The config is created as described in the
      file.  In this case a name element is required.  The new config is
      given this name.
    </li>
  </ul>
</p>

<p>
If there was no error with the command sent by the client, the manager will
assign a unique ID to the config and include this ID in
its reply to the client.
</p>

<p>
Command elements:
<ul>
  <li>&lt;rcfile&gt; is a file that defines the config.
      This file is in the openvasrc format.  The file must be Base64 encoded.
  <li>&lt;comment&gt; is a human-readable text.
  <li>&lt;copy&gt; is the UUID of an existing config.
  <li>&lt;get_configs_response&gt; is an element as returned by
      <a href="#get_configs">get_configs</a>.
  <li>&lt;name&gt; is a human-readable identifier.
</ul>
</p>

<h5>Examples:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;create_config&gt;
  &lt;copy&gt;daba56c8-73ec-11df-a475-002264764cea&lt;/copy&gt;
  &lt;name&gt;Full&lt;/name&gt;
&lt;/create_config&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_config_response status="201" status_text="OK, resource created" id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_config_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_config_response status="500" status_text="Internal error" /&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;create_config&gt;
  &lt;rcfile&gt;asdf3235saf3kjBVF...&lt;/rcfile&gt;
  &lt;name&gt;Full&lt;/name&gt;
&lt;/create_config&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_config_response status="201" status_text="OK, resource created" id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6" /&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;create_config&gt;
  &lt;get_configs_response&gt;
    &lt;config id="daba56c8-73ec-11df-a475-002264764cea"&gt;
      &lt;name&gt;Full and fast&lt;/name&gt;
      ...
    &lt;/config&gt;
  &lt;/get_configs_response&gt;
&lt;/create_config&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_config_response status="201" status_text="OK, resource created" id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6" /&gt;
</pre>

<h4 id="create_escalator">create_escalator</h4>

<p>
The client uses the create_escalator command to create a new escalator. This command must
include a human-readable identifier assigned by the user, an escalation condition, an
escalation event and an escalation method.  The command may include a comment.
</p>

<p>
If there was no error with the command sent by the client, the manager will
assign a unique ID to the escalator and include this ID in
its reply to the client.
</p>

<p>
Command elements:
<ul>
  <li>&lt;name&gt; is a human-readable identifier.
  <li>&lt;comment&gt; is a human-readable text.

  <li>
    &lt;condition&gt; is the condition that must be satisfied for escalation, e.g.
    "Threat level at least".
    <ul>
      <li>
        &lt;data&gt; is some data that defines the condition, e.g. "High".</li>
        <ul>
          <li>&lt;name&gt; is the name of the condition data, e.g. "level".</li>
        </ul>
      </li>
    </ul>
  </li>

  <li>
    &lt;event&gt; is the event that must happen for escalation, e.g.
    "Task run status changed".
    <ul>
      <li>
        &lt;data&gt; is some data that defines the event, e.g. "Done".</li>
        <ul>
          <li>&lt;name&gt; is the name of the event data, e.g. "status".</li>
        </ul>
      </li>
    </ul>
  </li>

  <li>
    &lt;method&gt; is the method by which escalation must occur, e.g. "Email".
    <ul>
      <li>
        &lt;data&gt; is some data that defines the method, e.g. "sally@example.org".</li>
        <ul>
          <li>&lt;name&gt; is the name of the method data, e.g. "to_address".</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;create_escalator&gt;
  &lt;name&gt;emergency&lt;/name&gt;
  &lt;condition&gt;
    Threat level at least
    &lt;data&gt;
      &lt;name&gt;level&lt;/name&gt;
      High
    &lt;/data&gt;
  &lt;/condition&gt;
  &lt;event&gt;
    Task run status changed
    &lt;data&gt;
      &lt;name&gt;status&lt;/name&gt;
      Done
    &lt;/data&gt;
  &lt;/event&gt;
  &lt;method&gt;
    Email
    &lt;data&gt;
      &lt;name&gt;to_address&lt;/name&gt;
      sally@example.org
    &lt;/data&gt;
    &lt;data&gt;
      &lt;name&gt;from_address&lt;/name&gt;
      bob@example.org
    &lt;/data&gt;
  &lt;/method&gt;
&lt;/create_escalator&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_escalator_response status="201" status_text="OK, resource created" id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_escalator_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_escalator_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="create_lsc_credential">create_lsc_credential</h4>

<p>
The client uses the create_lsc_credential command to create a new LSC credential.
This command must include a human-readable identifier assigned by the user,
and a login name.  The command may include a comment and a password.
</p>

<p>
If the command includes a password, then the manager creates a password only
credential, otherwise the manager creates a key-based credential.
</p>

<p>
If there was no error with the command sent by the client, the manager will
assign a unique ID to the credential and include this ID in
its reply to the client.
</p>

<p>
Command elements:
<ul>
  <li>&lt;name&gt; is a human-readable identifier.
  <li>&lt;login&gt; is a login name.
  <li>&lt;password&gt; is a password string.
  <li>&lt;comment&gt; is a human-readable text.
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;create_lsc_credential&gt;
  &lt;name&gt;cluster sally&lt;/name&gt;
  &lt;login&gt;sally&lt;/login&gt;
  &lt;password&gt;secret&lt;/password&gt;
  &lt;comment&gt;Sally's login to the cluster.&lt;/comment&gt;
&lt;/create_lsc_credential&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_lsc_credential_response status="201" status_text="OK, resource created" id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_lsc_credential_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_lsc_credential_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="create_note">create_note</h4>

<p>
The client uses the create_note command to create a new note.
This command must include a human-readable text and an NVT.  The command may
include a comment, a host list, a threat, a port, a task and a result.
</p>

<p>
If there was no error with the command sent by the client, the manager will
assign a unique ID to the note and include this ID in
its reply to the client.
</p>

<p>
Command elements:
<ul>
  <li>&lt;text&gt; is a human-readable text.
  <li>&lt;comment&gt; is a human-readable text.
  <li>&lt;hosts&gt; is a textual list of hosts.
  <li>&lt;nvt&gt; is an empty element with an oid attribute.
  <li>&lt;port&gt; is a port.
  <li>&lt;threat&gt; is a threat.
  <li>&lt;task&gt; is an empty element with an id attribute.
  <li>&lt;result&gt; is an empty element with an id attribute.
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;create_note&gt;
  &lt;text&gt;This issue should be resolved after the upgrade.&lt;/text&gt;
  &lt;nvt&gt;1.3.6.1.4.1.25623.1.0.10330&lt;/nvt&gt;
  &lt;result&gt;254cd3ef-bbe1-4d58-859d-21b8d0c046c6&lt;/result&gt;
&lt;/create_note&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_note_response status="201" status_text="OK, resource created" id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_note_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_note_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="create_override">create_override</h4>

<p>
The client uses the create_override command to create a new override.
This command must include a human-readable text, a new threat and an NVT.
The command may include a comment, a host list, a threat, a port, a task
and a result.
</p>

<p>
If there was no error with the command sent by the client, the manager will
assign a unique ID to the override and include this ID in
its reply to the client.
</p>

<p>
Command elements:
<ul>
  <li>&lt;text&gt; is a human-readable text.
  <li>&lt;comment&gt; is a human-readable text.
  <li>&lt;hosts&gt; is a textual list of hosts.
  <li>&lt;nvt&gt; is an empty element with an oid attribute.
  <li>&lt;port&gt; is a port.
  <li>&lt;threat&gt; is a threat.
  <li>&lt;new_threat&gt; is a threat.
  <li>&lt;task&gt; is an empty element with an id attribute.
  <li>&lt;result&gt; is an empty element with an id attribute.
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;create_override&gt;
  &lt;text&gt;This is actually of little concern.&lt;/text&gt;
  &lt;nvt&gt;1.3.6.1.4.1.25623.1.0.10330&lt;/nvt&gt;
  &lt;new_threat&gt;Low&lt;/new_threat&gt;
  &lt;result&gt;254cd3ef-bbe1-4d58-859d-21b8d0c046c6&lt;/result&gt;
&lt;/create_override&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_override_response status="201" status_text="OK, resource created" id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_override_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_override_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="create_schedule">create_schedule</h4>

<p>
The client uses the create_schedule command to create a new schedule.
This command must include a human-readable identifier assigned by the user,
a first time, a period and a duration.
The command may include a comment.
</p>

<p>
If there was no error with the command sent by the client, the manager will
assign a unique ID to the schedule and include this ID in
its reply to the client.
</p>

<p>
Command elements:
<ul>
  <li>&lt;name&gt; is a human-readable identifier.
  <li>&lt;comment&gt; is a human-readable text.

  <li>
    &lt;first_time&gt;
    <ul>
      <li>&lt;minute&gt; is an integer.</li>
      <li>&lt;hour&gt; is an integer.</li>
      <li>&lt;day_of_month&gt; is an integer.</li>
      <li>&lt;month&gt; is an integer.</li>
      <li>&lt;year&gt; is an integer.</li>
    </ul>
  </li>

  <li>
    &lt;duration&gt; is an integer.
    <ul>
      <li>
        &lt;unit&gt; is the unit of duration: second, minute, hour, day,
        week, month, year or decade.
      </li>
    </ul>
  </li>

  <li>
    &lt;period&gt; is an integer.
    <ul>
      <li>
        &lt;unit&gt; is the unit of period: second, minute, hour, day,
        week, month, year or decade.
      </li>
    </ul>
  </li>
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;create_schedule&gt;
  &lt;name&gt;Every night&lt;/name&gt;
  &lt;first_time&gt;
    &lt;day_of_month&gt;1&lt;/day_of_month&gt;
    &lt;hour&gt;0&lt;/hour&gt;
    &lt;minute&gt;0&lt;/minute&gt;
    &lt;month&gt;1&lt;/month&gt;
    &lt;year&gt;2011&lt;/year&gt;
  &lt;/first_time&gt;
  &lt;duration&gt;
    3
    &lt;unit&gt;hour&lt;/unit&gt;
  &lt;/duration&gt;
  &lt;period&gt;
    1
    &lt;unit&gt;day&lt;/unit&gt;
  &lt;/period&gt;
&lt;/create_schedule&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_schedule_response status="201" status_text="OK, resource created" id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_schedule_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_schedule_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="create_target">create_target</h4>

<p>
The client uses the create_target command to create a new target.
This command must include a human-readable identifier assigned by the user
and a list of hosts.  If the list of hosts is empty, the command must also
include a target locator.  The command may always include a comment and an
LSC credential.
</p>

<p>
If there was no error with the command sent by the client, the manager will
assign a unique ID to the target and include this ID in
its reply to the client.
</p>

<p>
Command elements:
<ul>
  <li>&lt;name&gt; is a human-readable identifier.
  <li>&lt;comment&gt; is a human-readable text.
  <li>&lt;hosts&gt; is a optionally empty textual list of hosts.
  <li>&lt;lsc_credential&gt; is an empty element with an id attribute.
  <li>
    &lt;target_locator&gt; is a name of a target locator.
    <ul>
      <li>&lt;username&gt; is a login name.</li>
      <li>&lt;password&gt; is a password.</li>
    </ul>
  </li>
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;create_target&gt;
  &lt;name&gt;All GNU/Linux machines&lt;/name&gt;
  &lt;hosts&gt;192.168.1.0/24&lt;/hosts&gt;
&lt;/create_target&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_target_response status="201" status_text="OK, resource created" id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_target_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_target_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="create_task">create_task</h4>

<p>
The client uses the create_task command to create a new task. This command must
always include an human-readable
identifier assigned by the user.
The command must also include either a config and target or a file specifying
the task.
The command may always include a comment.
If the command includes a config and target, it may also include an escalator
and schedule.
</p>

<p>
The file version of the command is special support for OpenVAS-Client, and
may be removed in upcoming versions.
</p>

<p>
If there was no error with the command sent by the client, the manager will
assign a unique ID to the task and include this ID in
its reply to the client.
</p>

<p>
Command elements:
<ul>
  <li>&lt;name&gt; is a human-readable identifier.
  <li>&lt;comment&gt; is a human-readable text.

  <li>&lt;config&gt; is an empty element with an id attribute.
  <li>&lt;target&gt; is an empty element with an id attribute.
  <li>&lt;escalator&gt; is an empty element with an id attribute.
  <li>&lt;schedule&gt; is an empty element with an id attribute.

  <li>&lt;rcfile&gt; is a file describing the task. As of OMP 1.0, this file is
in the openvasrc format. The file must be Base64 encoded.
</ul>
</p>

<h5>Examples:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;create_task&gt;
  &lt;name&gt;Scan Webserver&lt;/name&gt;
  &lt;comment&gt;Hourly scan of the webserver&lt;/comment&gt;
  &lt;config id="daba56c8-73ec-11df-a475-002264764cea"/&gt;
  &lt;target id="b493b7a8-7489-11df-a3ec-002264764cea"/&gt;
&lt;/create_task&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_task_response status="201" status_text="OK, resource created" id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_task_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_task_response status="500" status_text="Internal error" /&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;create_task&gt;
  &lt;rcfile&gt;asdf3235saf3kjBVF...&lt;/rcfile&gt;
  &lt;name&gt;Scan Webserver&lt;/name&gt;
  &lt;comment&gt;Hourly scan of the webserver&lt;/comment&gt;
&lt;/create_task&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_task_response status="201" status_text="OK, resource created" id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_task_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;create_task_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="delete_agent">delete_agent</h4>

<p>
The client uses the delete_agent command to delete an existing agent. This
command must include the ID of an existing agent.
</p>

<p>
If there was no error with the command sent by the client, the manager will
delete the agent and will reply with a response code indicating success.
</p>

<p>
Since this is a destructive command, the client is advised to ask for confirmation
from the user before sending this command to the manager.
</p>

<p>
Command attributes:
<ul>
  <li>"agent_id" is the ID of the agent which should be deleted.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;delete_agent agent_id="267a3405-e84a-47da-97b2-5fa0d2e8995e" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_agent_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_agent_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_agent_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="delete_config">delete_config</h4>

<p>
The client uses the delete_config command to delete an existing config. This
command must include the ID of an existing config.
</p>

<p>
If there was no error with the command sent by the client, the manager will
delete the config and will reply with a response code indicating success.
</p>

<p>
Since this is a destructive command, the client is advised to ask for confirmation
from the user before sending this command to the manager.
</p>

<p>
Command attributes:
<ul>
  <li>"config_id" is the ID of the config which should be deleted.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;delete_config config_id="267a3405-e84a-47da-97b2-5fa0d2e8995e" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_config_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_config_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_config_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="delete_escalator">delete_escalator</h4>

<p>
The client uses the delete_escalator command to delete an existing escalator. This
command must include the ID of an existing escalator.
</p>

<p>
If there was no error with the command sent by the client, the manager will
delete the escalator and will reply with a response code indicating success.
</p>

<p>
Since this is a destructive command, the client is advised to ask for confirmation
from the user before sending this command to the manager.
</p>

<p>
Command attributes:
<ul>
  <li>"escalator_id" is the ID of the escalator which should be deleted.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;delete_escalator escalator_id="267a3405-e84a-47da-97b2-5fa0d2e8995e" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_escalator_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_escalator_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_escalator_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="delete_lsc_credential">delete_lsc_credential</h4>

<p>
The client uses the delete_lsc_credential command to delete an existing LSC credential.
This command must include the ID of an existing LSC credential.
</p>

<p>
If there was no error with the command sent by the client, the manager will
delete the LSC credential and will reply with a response code indicating success.
</p>

<p>
Since this is a destructive command, the client is advised to ask for confirmation
from the user before sending this command to the manager.
</p>

<p>
Command attributes:
<ul>
  <li>"lsc_credential_id" is the ID of the LSC credential which should be deleted.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;delete_lsc_credential lsc_credential_id="267a3405-e84a-47da-97b2-5fa0d2e8995e" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_lsc_credential_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_lsc_credential_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_lsc_credential_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="delete_note">delete_note</h4>

<p>
The client uses the delete_note command to delete an existing note. This
command must include the ID of an existing note.
</p>

<p>
If there was no error with the command sent by the client, the manager will
delete the note and will reply with a response code indicating success.
</p>

<p>
Since this is a destructive command, the client is advised to ask for confirmation
from the user before sending this command to the manager.
</p>

<p>
Command attributes:
<ul>
  <li>"note_id" is the ID of the note which should be deleted.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;delete_note note_id="267a3405-e84a-47da-97b2-5fa0d2e8995e" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_note_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_note_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_note_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="delete_override">delete_override</h4>

<p>
The client uses the delete_override command to delete an existing override. This
command must include the ID of an existing override.
</p>

<p>
If there was no error with the command sent by the client, the manager will
delete the override and will reply with a response code indicating success.
</p>

<p>
Since this is a destructive command, the client is advised to ask for confirmation
from the user before sending this command to the manager.
</p>

<p>
Command attributes:
<ul>
  <li>"override_id" is the ID of the override which should be deleted.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;delete_override override_id="267a3405-e84a-47da-97b2-5fa0d2e8995e" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_override_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_override_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_override_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="delete_report">delete_report</h4>

<p>
The client uses the delete_report command to delete an existing report. This
command must include the ID of an existing report.
</p>

<p>
If there was no error with the command sent by the client, the manager will
delete the report and will reply with a response code indicating success.
</p>

<p>
Since this is a destructive command, the client is advised to ask for confirmation
from the user before sending this command to the manager.
</p>

<p>
Command attributes:
<ul>
  <li>"report_id" is the ID of the report which should be deleted.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;delete_report report_id="267a3405-e84a-47da-97b2-5fa0d2e8995e" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_report_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_report_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_report_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="delete_schedule">delete_schedule</h4>

<p>
The client uses the delete_schedule command to delete an existing schedule. This
command must include the ID of an existing schedule.
</p>

<p>
If there was no error with the command sent by the client, the manager will
delete the schedule and will reply with a response code indicating success.
</p>

<p>
Since this is a destructive command, the client is advised to ask for confirmation
from the user before sending this command to the manager.
</p>

<p>
Command attributes:
<ul>
  <li>"schedule_id" is the ID of the schedule which should be deleted.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;delete_schedule schedule_id="267a3405-e84a-47da-97b2-5fa0d2e8995e" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_schedule_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_schedule_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_schedule_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="delete_target">delete_target</h4>

<p>
The client uses the delete_target command to delete an existing target. This
command must include the ID of an existing target.
</p>

<p>
If there was no error with the command sent by the client, the manager will
delete the target and will reply with a response code indicating success.
</p>

<p>
Since this is a destructive command, the client is advised to ask for confirmation
from the user before sending this command to the manager.
</p>

<p>
Command attributes:
<ul>
  <li>"target_id" is the ID of the target which should be deleted.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;delete_target target_id="267a3405-e84a-47da-97b2-5fa0d2e8995e" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_target_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_target_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_target_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="delete_task">delete_task</h4>

<p>
The client uses the delete_task command to delete an existing task. This
command must include the ID of an existing task.
</p>

<p>
If there was no error with the command sent by the client, the manager will
delete the task and all relevant objects (reports etc.) and will reply with a
response code indicating success and the ID of the task that was deleted.
</p>

<p>
Since this is a destructive command, the client is advised to ask for confirmation
from the user before sending this command to the manager.
</p>

<p>
Command attributes:
<ul>
  <li>"task_id" is the ID of the task which should be deleted.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;delete_task task_id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6" /&gt;
</pre>

<p><
b>M:</b>
</p>

<pre>
&lt;delete_task_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_task_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;delete_task_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="get_agents">get_agents</h4>

<p>
The client uses the get_agents command to get agent information. This command may
include the ID of an existing agent, a format, a sort order and a sort field.
</p>

<p>
If there was no error with the command sent by the client, the manager will
reply with a list of agents to the client.
</p>

<p>
Command attributes:
<ul>
  <li>"agent_id" is the ID of an agent.
  <li>"format" is either "installer", "howto_install" or "howto_use".
  <li>"sort_order" is "descending" for descending, anything else for ascending.
  <li>"sort_field" is the field to sort on.
</ul>
</p>

<h5>Examples:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_agents /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_agents_response status="200" status_text="OK"&gt;
  &lt;agent id="c33864a9-d3fd-44b3-8717-972bfb01dfcf"&gt;
    &lt;name&gt;Custom Scan Agent&lt;/name&gt;
    &lt;comment&gt;Custom agent for use on the Web servers.&lt;/comment&gt;
    &lt;in_use&gt;1&lt;/in_use&gt;
    &lt;installer&gt;&lt;trust&gt;yes&lt/trust&gt&lt;/installer&gt;
  &lt;/agent&gt;
  ...
&lt;/get_agents_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_agents agent_id="c33864a9-d3fd-44b3-8717-972bfb01dfcf" format="installer"/&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_agents_response status="200" status_text="OK"&gt;
  &lt;agent id="c33864a9-d3fd-44b3-8717-972bfb01dfcf"&gt;
    &lt;name&gt;Custom Scan Agent&lt;/name&gt;
    &lt;comment&gt;Custom agent for use on the Web servers.&lt;/comment&gt;
    &lt;in_use&gt;1&lt;/in_use&gt;
m4_dnl TODO get_lsc_credentials package uses format to denote file type
    &lt;package format="installer"&gt;
      &lt;filename&gt;agent.deb&lt;/filename&gt;
      CgoKCgoKCgoKCgoKCSAgI...
    &lt;/package&gt;
  &lt;/agent&gt;
&lt;/get_agents_response&gt;
</pre>

m4_dnl <h4 id="get_certificates">get_certificates</h4>
m4_dnl
m4_dnl <p>
m4_dnl The client uses the get_certificates command to request all certificates
m4_dnl available through this manager. If the manager possesses such a collection, it
m4_dnl will reply with a response code indicating success, and the certificates. If
m4_dnl the manager cannot access a list of available certificates at present, it will
m4_dnl reply with a response code in the 5xx range.
m4_dnl </p>
m4_dnl
m4_dnl <p>
m4_dnl Command elements:
m4_dnl <ul>
m4_dnl   <li>(n/a)
m4_dnl </ul>
m4_dnl </p>
m4_dnl
m4_dnl <h5>Example:</h5>
m4_dnl
m4_dnl <p>
m4_dnl <b>C:</b>
m4_dnl </p>
m4_dnl
m4_dnl <pre>
m4_dnl &lt;get_certificates/&gt;
m4_dnl </pre>
m4_dnl
m4_dnl <p>
m4_dnl <b>M:</b>
m4_dnl </p>
m4_dnl
m4_dnl <pre>
m4_dnl &lt;get_certificates_response status="200" status_text="OK"&gt;
m4_dnl   // TODO
m4_dnl &lt;/get_certificates_response&gt;
m4_dnl </pre>

<h4 id="get_configs">get_configs</h4>

<p>
The client uses the get_configs command to get config information. This command may
include the ID of an existing config, a families flag, an export flag, a preferences
flag, a sort order and a sort field.
</p>

<p>
If there was no error with the command sent by the client, the manager will
reply with a list of configs to the client.
</p>

<p>
Command attributes:
<ul>
  <li>"config_id" is the ID of a config.
  <li>"families" is boolean (0 is false, anything else is true).
  <li>"preferences" is boolean (0 is false, anything else is true).
  <li>"sort_order" is "descending" for descending, anything else for ascending.
  <li>"sort_field" is the field to sort on.
</ul>
</p>

<h5>Examples:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_configs /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_configs_response status="200" status_text="OK"&gt;
  &lt;config id="daba56c8-73ec-11df-a475-002264764cea"&gt;
    &lt;name&gt;Full and fast&lt;/name&gt;
    &lt;comment&gt;All NVT&apos;s; optimized by using previously collected information.&lt;/comment&gt;
    &lt;family_count&gt;
      4
      &lt;growing&gt;1&lt;/growing&gt;
    &lt;/family_count&gt;
    &lt;nvt_count&gt;
      12
      &lt;growing&gt;1&lt;/growing&gt;
    &lt;/nvt_count&gt;
    &lt;in_use&gt;1&lt;/in_use&gt;
    &lt;tasks&gt;
      &lt;task id="13bb418a-4220-4575-b35b-ec398bff7417"&gt;
        &lt;name&gt;Web Servers&lt;/name&gt;
      &lt;/task&gt;
      ...
    &lt;/tasks&gt;
  &lt;/config&gt;
  ...
&lt;/get_configs_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_configs config_id="daba56c8-73ec-11df-a475-002264764cea" preferences="1" families="1" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_configs_response status="200" status_text="OK"&gt;
  &lt;config id="daba56c8-73ec-11df-a475-002264764cea"&gt;
    &lt;name&gt;Full and fast&lt;/name&gt;
    &lt;comment&gt;All NVT&apos;s; optimized by using previously collected information.&lt;/comment&gt;
    &lt;family_count&gt;
      4
      &lt;growing&gt;1&lt;/growing&gt;
    &lt;/family_count&gt;
    &lt;nvt_count&gt;
      12
      &lt;growing&gt;1&lt;/growing&gt;
    &lt;/nvt_count&gt;
    &lt;in_use&gt;1&lt;/in_use&gt;
    &lt;tasks&gt;
      &lt;task id="13bb418a-4220-4575-b35b-ec398bff7417"&gt;
        &lt;name&gt;Web Servers&lt;/name&gt;
      &lt;/task&gt;
      ...
    &lt;/tasks&gt;
    &lt;families&gt;
      &lt;family&gt;
        &lt;name&gt;Credentials&lt;/name&gt;
        &lt;nvt_count&gt;8&lt;/nvt_count&gt;
        &lt;max_nvt_count&gt;8&lt;/max_nvt_count&gt;
        &lt;growing&gt;1&lt;/growing&gt;
      &lt;/family&gt;
      ...
    &lt;/families&gt;
    &lt;preferences&gt;
      &lt;preference&gt;
        &lt;nvt oid="1.3.6.1.4.1.25623.1.0.10330"&gt;
          &lt;name&gt;Services&lt;/name&gt;
        &lt;/nvt&gt;
        &lt;name&gt;Network connection timeout :&lt;/name&gt;
        &lt;type&gt;entry&lt;/type&gt;
        &lt;value&gt;5&lt;/value&gt;
      &lt;/preference&gt;
      ...
    &lt;/preferences&gt;
  &lt;/config&gt;
  ...
&lt;/get_configs_response&gt;
</pre>

<h4 id="get_dependencies">get_dependencies</h4>

<p>
The client uses the get_dependencies command to request the dependencies for one
or all NVTs available through this manager.  This command may include an NVT
OID.
</p>

<p>
If the manager possesses such a collection, it will reply with a response
code indicating success, and the dependencies.  If the manager cannot
access a list of available NVTs at present, it will reply with the 503
response.
</p>

<p>
Command attributes:
<ul>
  <li>"nvt_oid" is the OID of an NVT.
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_dependencies/&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_dependencies_response status="200" status_text="OK"&gt;
  &lt;nvt oid="1.3.6.1.4.1.25623.1.0.114664"&gt;
    &lt;name&gt;Dependency Test&lt;/name&gt;
    &lt;requires&gt;
      &lt;nvt oid="1.3.6.1.4.1.25623.1.0.114663"&gt;
        &lt;name&gt;File Upload Test&lt;/name&gt;
      &lt;/nvt&gt;
    &lt;/requires&gt;
  &lt;/nvt&gt;
  ...
&lt;/get_dependencies_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_dependencies nvt_oid="1.3.6.1.4.1.25623.1.0.114664" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_dependencies_response status="200" status_text="OK"&gt;
  &lt;nvt oid="1.3.6.1.4.1.25623.1.0.114664"&gt;
    &lt;name&gt;Dependency Test&lt;/name&gt;
    &lt;requires&gt;
      &lt;nvt oid="1.3.6.1.4.1.25623.1.0.114663"&gt;
        &lt;name&gt;File Upload Test&lt;/name&gt;
      &lt;/nvt&gt;
    &lt;/requires&gt;
  &lt;/nvt&gt;
&lt;/get_dependencies_response&gt;
</pre>

<h4 id="get_escalators">get_escalators</h4>

<p>
The client uses the get_escalators command to get escalator information. This
command may include the ID of an existing escalator, a sort order and a sort
field.
</p>

<p>
If there was no error with the command sent by the client, the manager will
reply with a list of escalators to the client.
</p>

<p>
Command attributes:
<ul>
  <li>"escalator_id" is the ID of an escalator.
  <li>"sort_order" is "descending" for descending, anything else for ascending.
  <li>"sort_field" is the field to sort on.
</ul>
</p>

<h5>Examples:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_escalators /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_escalators_response status="200" status_text="OK"&gt;
  &lt;escalator id="6181e65d-8ba0-4937-9c44-8f2b10b0def7"&gt;
    &lt;name&gt;Team alert&lt;/name&gt;
    &lt;comment&gt;&lt;/comment&gt;
    &lt;in_use&gt;1&lt;/in_use&gt;
    &lt;condition&gt;
      Threat level at least
      &lt;data&gt;
        &lt;name&gt;level&lt;/name&gt;
        High
      &lt;/data&gt;
    &lt;/condition&gt;
    &lt;event&gt;
      Task run status changed
      &lt;data&gt;
        &lt;name&gt;status&lt;/name&gt;
        Done
      &lt;/data&gt;
    &lt;/event&gt;
    &lt;method&gt;
      Email
      &lt;data&gt;
        &lt;name&gt;to_address&lt;/name&gt;
        team@example.org
      &lt;/data&gt;
      &lt;data&gt;
        &lt;name&gt;from_address&lt;/name&gt;
        admin@example.org
      &lt;/data&gt;
      &lt;data&gt;
        &lt;name&gt;notice&lt;/name&gt;
        0
      &lt;/data&gt;
    &lt;/method&gt;
  &lt;/escalator&gt;
  ...
&lt;/get_escalators_response&gt;
</pre>

<h4 id="get_lsc_credentials">get_lsc_credentials</h4>

<p>
The client uses the get_lsc_credentials command to get LSC credential
information. This command may include the ID of an existing LSC credential,
a format, a sort order and a sort field.
</p>

<p>
If there was no error with the command sent by the client, the manager will
reply with a list of LSC credentials to the client.
</p>

<p>
Command attributes:
<ul>
  <li>"lsc_credential_id" is the ID of an LSC credential.</li>
  <li>"format" is a string describing the requested format.</li>
  <li>"sort_order" is "descending" for descending, anything else for ascending.</li>
  <li>"sort_field" is the field to sort on.</li>
</ul>
</p>

<h5>Examples:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_lsc_credentials /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_lsc_credentials_response status="200" status_text="OK"&gt;
  &lt;lsc_credential id="c33864a9-d3fd-44b3-8717-972bfb01dfcf"&gt;
    &lt;name&gt;sally&lt;/name&gt;
    &lt;login&gt;sally&lt;/login&gt;
    &lt;comment&gt;&lt;/comment&gt;
    &lt;in_use&gt;0&lt;/in_use&gt;
    &lt;type&gt;gen&lt;/type&gt;
    &lt;targets&gt;&lt;/targets&gt;
  &lt;/lsc_credential&gt;
  &lt;lsc_credential id="8e305b0b-260d-450d-91a8-dadf0b144e15"&gt;
    &lt;name&gt;bob&lt;/name&gt;
    &lt;login&gt;bob&lt;/login&gt;
    &lt;comment&gt;Bob on the web server.&lt;/comment&gt;
    &lt;in_use&gt;1&lt;/in_use&gt;
    &lt;type&gt;pass&lt;/type&gt;
    &lt;targets&gt;
      &lt;target id="1f28d970-17ef-4c69-ba8a-13827059f2b9"&gt;
        &lt;name&gt;Web server&lt;/name&gt;
      &lt;/target&gt;
    &lt;/targets&gt;
  &lt;/lsc_credential&gt;
  ...
&lt;/get_lsc_credentials_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_lsc_credentials lsc_credential_id="8e305b0b-260d-450d-91a8-dadf0b144e15" format="key"/&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_lsc_credentials_response status="200" status_text="OK"&gt;
  &lt;lsc_credential id="8e305b0b-260d-450d-91a8-dadf0b144e15"&gt;
    &lt;name&gt;bob&lt;/name&gt;
    &lt;login&gt;bob&lt;/login&gt;
    &lt;comment&gt;Bob on the web server.&lt;/comment&gt;
    &lt;in_use&gt;1&lt;/in_use&gt;
    &lt;type&gt;pass&lt;/type&gt;
    &lt;targets&gt;
      &lt;target id="1f28d970-17ef-4c69-ba8a-13827059f2b9"&gt;
        &lt;name&gt;Web server&lt;/name&gt;
      &lt;/target&gt;
    &lt;/targets&gt;
    &lt;public_key&gt;
      ssh-rsa AAAAB3...Z64IcQ== Key generated by OpenVAS Manager
    &lt;/public_key&gt;
  &lt;/lsc_credential&gt;
&lt;/get_lsc_credentials_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_lsc_credentials lsc_credential_id="8e305b0b-260d-450d-91a8-dadf0b144e15" format="deb"/&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_lsc_credentials_response status="200" status_text="OK"&gt;
  &lt;lsc_credential id="8e305b0b-260d-450d-91a8-dadf0b144e15"&gt;
    &lt;name&gt;bob&lt;/name&gt;
    &lt;login&gt;bob&lt;/login&gt;
    &lt;comment&gt;Bob on the web server.&lt;/comment&gt;
    &lt;in_use&gt;1&lt;/in_use&gt;
    &lt;type&gt;pass&lt;/type&gt;
    &lt;targets&gt;
      &lt;target id="1f28d970-17ef-4c69-ba8a-13827059f2b9"&gt;
        &lt;name&gt;Web server&lt;/name&gt;
      &lt;/target&gt;
    &lt;/targets&gt;
    &lt;package format="deb"&gt;ITxhcmNoPgpk...DmvF0AKAAACg==&lt;/package&gt;
  &lt;/lsc_credential&gt;
&lt;/get_lsc_credentials_response&gt;
</pre>

<h4 id="get_notes">get_notes</h4>

<p>
The client uses the get_notes command to get note information. This command may
include the ID of an existing note, a details flag, a result flag, an NVT, a
task, a sort order and a sort field.
</p>

<p>
If there was no error with the command sent by the client, the manager will
reply with a list of notes to the client.
</p>

<p>
Command attributes:
<ul>
  <li>"note_id" is the ID of a note.</li>
  <li>"nvt_oid" is the OID of an NVT.</li>
  <li>"task_id" is the ID of a task.</li>
  <li>"details" is boolean (0 is false, anything else is true).</li>
  <li>"result" is boolean (0 is false, anything else is true).</li>
  <li>"sort_order" is "descending" for descending, anything else for ascending.</li>
  <li>"sort_field" is the field to sort on.</li>
</ul>
</p>

<h5>Examples:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_notes /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_notes_response status="200" status_text="OK"&gt;
  &lt;note id="b76b81a7-9df8-42df-afff-baa9d4620128"&gt;
    &lt;nvt oid="1.3.6.1.4.1.25623.1.0.75"&gt;
      &lt;name&gt;Test NVT: long lines&lt;/name&gt;
    &lt;/nvt&gt;
    &lt;text excerpt="0"&gt;This is the full text of the note.&lt;/text&gt;
    &lt;orphan&gt;1&lt;/orphan&gt;
  &lt;/note&gt;
  ...
&lt;/get_notes_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_notes note_id="7f618bbb-4664-419e-9bbf-367d93954cb0" details="1" result="1"/&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_notes_response status="200" status_text="OK"&gt;
  &lt;note id="7f618bbb-4664-419e-9bbf-367d93954cb0"&gt;
    &lt;nvt oid="1.3.6.1.4.1.25623.1.0.77"&gt;
      &lt;name&gt;Test NVT: control chars in report result&lt;/name&gt;
    &lt;/nvt&gt;
    &lt;creation_time&gt;Sun Jun 27 08:49:46 2010&lt;/creation_time&gt;
    &lt;modification_time&gt;Sun Jun 27 08:49:46 2010&lt;/modification_time&gt;
    &lt;text&gt;note fixed to result&lt;/text&gt;
    &lt;hosts&gt;127.0.0.1&lt;/hosts&gt;
    &lt;port&gt;general/tcp&lt;/port&gt;
    &lt;threat&gt;Medium&lt;/threat&gt;
    &lt;task id="40b236a9-2b0f-4813-b8c7-bc2b98d9d7e4"&gt;
      &lt;name&gt;test&lt;/name&gt;
    &lt;/task&gt;
    &lt;orphan&gt;0&lt;/orphan&gt;
    &lt;result id="0c95e6b3-1100-4dfd-88f1-4bed1fad29de"&gt;
      &lt;subnet&gt;127.0.0.1&lt;/subnet&gt;
      &lt;host&gt;127.0.0.1&lt;/host&gt;
      &lt;port&gt;general/tcp&lt;/port&gt;
      &lt;nvt oid="1.3.6.1.4.1.25623.1.0.77"&gt;
        &lt;name&gt;Test NVT: control chars in report result&lt;/name&gt;
        &lt;cvss_base&gt;&lt;/cvss_base&gt;
        &lt;risk_factor&gt;&lt;/risk_factor&gt;
      &lt;/nvt&gt;
      &lt;threat&gt;Medium&lt;/threat&gt;
      &lt;description&gt;Warning with control char between fullstops: . .&lt;/description&gt;
    &lt;/result&gt;
  &lt;/note&gt;
  ...
&lt;/get_notes_response&gt;
</pre>

<h4 id="get_nvts">get_nvts</h4>

<p>
The client uses the get_nvts command to request NVT information.
This command may include one of an NVT OID and a family name.
This command may always include a details flag, a config, a sort order and
a sort field.  If the command includes a details flag, it may also include
timeout, preference_count and preferences flags.  The timeout and preferences
flags require a config.
</p>

<p>
The NVT OID, family name and config attributes limit the listing
to a single NVT or all NVTs in a particular family and/or config.
With the preferences flag the manager includes in the listing, the values
of each listed NVT's preferences for the given config.  The timeout flag does
the same for the special timeout preference.
</p>

<p>
If the manager possesses an NVT collection, it will reply with a response
code indicating success, and the NVT information.  If the manager cannot
access a list of available NVTs at present, it will reply with the 503
response.
</p>

<p>
Command attributes:
<ul>
  <li>"nvt_oid" is the OID of an NVT.
  <li>"details" is boolean (0 is false, anything else is true).
  <li>"preferences" is boolean (0 is false, anything else is true).
  <li>"preference_count" is boolean (0 is false, anything else is true).
  <li>"timeout" is boolean (0 is false, anything else is true).
  <li>"config_id" is the ID of a config.
  <li>"family" is the name of a family.
  <li>"sort_order" is "descending" for descending, anything else for ascending.
  <li>"sort_field" is the field to sort on.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_nvts details="1" timeout="1" preference_count="1" preferences="1"/&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_nvts_response status="200" status_text="OK"&gt;
  &lt;nvt oid="1.3.6.1.4.1.25623.1.7.13005"&gt;
    &lt;name&gt;Services&lt;/name&gt;
    &lt;category&gt;Services&lt;/category&gt;
    &lt;copyright&gt;GNU GPL v2&lt;/copyright&gt;
    &lt;description&gt;This script attepts to detects with service is running on which port.&lt;/description&gt;
    &lt;summary&gt;Find what is listening on which port&lt;/summary&gt;
    &lt;family&gt;Service detection&lt;/family&gt;
    &lt;version&gt;$Revision: 1852 $&lt;/version&gt;
    &lt;cvss_base&gt;&lt;/cvss_base&gt;
    &lt;risk_factor&gt;None&lt;/risk_factor&gt;
    &lt;cve_id&gt;NOCVE&lt;/cve_id&gt;
    &lt;bugtraq_id&gt;NOBID&lt;/bugtraq_id&gt;
    &lt;xrefs&gt;NOXREF&lt;/xrefs&gt;
    &lt;fingerprints&gt;NOSIGNKEYS&lt;/fingerprints&gt;
    &lt;tags&gt;NOTAG&lt;/tags&gt;
    &lt;preference_count&gt;-1&lt;/preference_count&gt;
    &lt;timeout&gt;&lt;/timeout&gt;
    &lt;checksum&gt;
      &lt;algorithm&gt;md5&lt;/algorithm&gt;
      2397586ea5cd3a69f953836f7be9ef7b
    &lt;/checksum&gt;
    &lt;preferences&gt;
      &lt;timeout&gt;&lt;/timeout&gt;
      &lt;preference&gt;
        &lt;nvt oid="1.3.6.1.4.1.25623.1.0.10330"&gt;
          &lt;name&gt;Services&lt;/name&gt;
        &lt;/nvt&gt;
        &lt;name&gt;Network connection timeout :&lt;/name&gt;
        &lt;type&gt;entry&lt;/type&gt;
        &lt;value&gt;5&lt;/value&gt;
      &lt;/preference&gt;
      ...
    &lt;/preferences&gt;
  &lt;/nvt&gt;
  &lt;nvt oid="1.3.6.1.4.1.25623.1.7.13006"&gt;
    &lt;name&gt;FooBar 21&lt;/name&gt;
    &lt;category&gt;Services&lt;/category&gt;
    &lt;copyright&gt;GNU GPL v2&lt;/copyright&gt;
    &lt;description&gt;This script detects whether the FooBar 2.1 XSS vulnerability is present.&lt;/description&gt;
    ...
  &lt;/nvt&gt;
  ...
&lt;/get_nvts_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_nvts nvt_oid="1.3.6.1.4.1.25623.1.0.10330" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_nvts_response status="200" status_text="OK"&gt;
  &lt;nvt oid="1.3.6.1.4.1.25623.1.0.10330"&gt;
    &lt;name&gt;Services&lt;/name&gt;
    &lt;checksum&gt;
      &lt;algorithm&gt;md5&lt;/algorithm&gt;
      2397586ea5cd3a69f953836f7be9ef7b
    &lt;/checksum&gt;
  &lt;/nvt&gt;
&lt;/get_nvts_response&gt;
</pre>

<h4 id="get_nvt_families">get_nvt_families</h4>

<p>
The client uses the get_nvt_families command to get NVT family information.
This command may include a sort order.
</p>

<p>
If there was no error with the command sent by the client, the manager will
reply with a list of families to the client.
</p>

<p>
Command attributes:
<ul>
  <li>"sort_order" is "descending" for descending, anything else for ascending.</li>
</ul>
</p>

<h5>Examples:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_nvt_families /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_nvt_families_response status="200" status_text="OK"&gt;
  &lt;families&gt;
    &lt;family&gt;
      &lt;name&gt;Credentials&lt;/name&gt;
      &lt;max_nvt_count&gt;8&lt;/max_nvt_count&gt;
    &lt;/family&gt;
    &lt;family&gt;
      &lt;name&gt;Port scanners&lt;/name&gt;
      &lt;max_nvt_count&gt;12&lt;/max_nvt_count&gt;
    &lt;/family&gt;
    ...
  &lt;/families&gt;
&lt;/get_nvt_families_response&gt;
</pre>


<h4 id="get_nvt_feed_checksum">get_nvt_feed_checksum</h4>

<p>
The client uses the get_nvt_feed_checksum command to request a checksum for the
complete NVT collection available through this manager. The client may specify
an algorithm to be used for computing this checksum.
</p>

<p>
If the specified algorithm is not implemented in the manager, then the manager
will reply with a response code in the 4xx range.
</p>

<p>
If the client does not specify a checksum algorithm, the manager is expected to
use the MD5 algorithm for computing the checksum.
</p>

<p>
If the manager possesses such a collection, it will reply with a response code
indicating success, and the checksum over all NVT files. If the manager
cannot access a list of available NVTs at present, it will reply with the 503
response.
</p>

<p>
Command attributes:
<ul>
  <li>"algorithm" is the algorithm which should be used for computing the
  checksum.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_nvt_feed_checksum algorithm="md5" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_nvt_feed_checksum_response status="200" status_text="OK"&gt;
  &lt;checksum algorithm="md5"&gt;931db829a06b9a440a2ecaeb68c03715&lt;/checksum&gt;
&lt;/get_nvt_feed_checksum_response&gt;
</pre>

<h4 id="get_overrides">get_overrides</h4>

<p>
The client uses the get_overrides command to get override information. This command may
include the ID of an existing override, a details flag, a result flag, an NVT, a
task, a sort order and a sort field.
</p>

<p>
If there was no error with the command sent by the client, the manager will
reply with a list of overrides to the client.
</p>

<p>
Command attributes:
<ul>
  <li>"override_id" is the ID of an override.</li>
  <li>"nvt_oid" is the OID of an NVT.</li>
  <li>"task_id" is the ID of a task.</li>
  <li>"details" is boolean (0 is false, anything else is true).</li>
  <li>"result" is boolean (0 is false, anything else is true).</li>
  <li>"sort_order" is "descending" for descending, anything else for ascending.</li>
  <li>"sort_field" is the field to sort on.</li>
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)</li>
</ul>
</p>

<h5>Examples:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_overrides /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_overrides_response status="200" status_text="OK"&gt;
  &lt;override id="b76b81a7-9df8-42df-afff-baa9d4620128"&gt;
    &lt;nvt oid="1.3.6.1.4.1.25623.1.0.75"&gt;
      &lt;name&gt;Test NVT: long lines&lt;/name&gt;
    &lt;/nvt&gt;
    &lt;text excerpt="0"&gt;This is the full text of the override.&lt;/text&gt;
    &lt;threat&gt;High&lt;/threat&gt;
    &lt;new_threat&gt;Log&lt;/new_threat&gt;
    &lt;orphan&gt;1&lt;/orphan&gt;
  &lt;/override&gt;
  ...
&lt;/get_overrides_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_overrides override_id="7f618bbb-4664-419e-9bbf-367d93954cb0" details="1"/&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_overrides_response status="200" status_text="OK"&gt;
  &lt;override id="7f618bbb-4664-419e-9bbf-367d93954cb0"&gt;
    &lt;nvt oid="1.3.6.1.4.1.25623.1.0.77"&gt;
      &lt;name&gt;Test NVT: control chars in report result&lt;/name&gt;
    &lt;/nvt&gt;
    &lt;creation_time&gt;Sun Jun 27 08:49:46 2010&lt;/creation_time&gt;
    &lt;modification_time&gt;Sun Jun 27 08:49:46 2010&lt;/modification_time&gt;
    &lt;text&gt;override fixed to result&lt;/text&gt;
    &lt;hosts&gt;127.0.0.1&lt;/hosts&gt;
    &lt;port&gt;general/tcp&lt;/port&gt;
    &lt;threat&gt;Medium&lt;/threat&gt;
    &lt;new_threat&gt;Low&lt;/new_threat&gt;
    &lt;task id="40b236a9-2b0f-4813-b8c7-bc2b98d9d7e4"&gt;
      &lt;name&gt;test&lt;/name&gt;
    &lt;/task&gt;
    &lt;orphan&gt;0&lt;/orphan&gt;
    &lt;result id="0c95e6b3-1100-4dfd-88f1-4bed1fad29de" /&gt;
  &lt;/override&gt;
  ...
&lt;/get_overrides_response&gt;
</pre>

<h4 id="get_preferences">get_preferences</h4>

<p>
The client uses the get_preferences command to request NVT preferences.  This
command may include an NVT OID, a config ID and a preference name.
</p>

<p>
If the manager possesses such a collection, it will reply with a response
code indicating success, and the NVT preferences.  If the manager cannot
access a list of available NVTs at present, it will reply with the 503
response.
</p>

<p>
Command attributes:
<ul>
  <li>"nvt_oid" is the OID of an NVT.
  <li>"config_id" is the ID of a config.
  <li>"preference" is the name of a preference.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_preferences/&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_preferences_response status="200" status_text="OK"&gt;
  &lt;preference&gt;
    &lt;name&gt;Services[entry]:Network connection timeout :&lt;/name&gt;
    &lt;value&gt;5&lt;/value&gt;
  &lt;/preference&gt;
  ...
&lt;/get_preferences_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_preferences nvt_oid="1.3.6.1.4.1.25623.1.0.10330" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_preferences_response status="200" status_text="OK"&gt;
  &lt;preference&gt;
    &lt;name&gt;Services[entry]:Network connection timeout :&lt;/name&gt;
    &lt;value&gt;5&lt;/value&gt;
  &lt;/preference&gt;
  ...
&lt;/get_preferences_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_preferences config_id="daba56c8-73ec-11df-a475-002264764cea"/&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_preferences_response status="200" status_text="OK"&gt;
  &lt;preference&gt;
    &lt;nvt oid="1.3.6.1.4.1.25623.1.0.10330"&gt;
      &lt;name&gt;Services&lt;/name&gt;
    &lt;/nvt&gt;
    &lt;name&gt;Network connection timeout :&lt;/name&gt;
    &lt;type&gt;entry&lt;/type&gt;
    &lt;value&gt;5&lt;/value&gt;
  &lt;/preference&gt;
  ...
&lt;/get_preferences_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_preferences config_id="daba56c8-73ec-11df-a475-002264764cea" nvt_oid="1.3.6.1.4.1.25623.1.0.10330" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_preferences_response status="200" status_text="OK"&gt;
  &lt;preference&gt;
    &lt;nvt oid="1.3.6.1.4.1.25623.1.0.10330"&gt;
      &lt;name&gt;Services&lt;/name&gt;
    &lt;/nvt&gt;
    &lt;name&gt;Network connection timeout :&lt;/name&gt;
    &lt;type&gt;entry&lt;/type&gt;
    &lt;value&gt;5&lt;/value&gt;
  &lt;/preference&gt;
  ...
&lt;/get_preferences_response&gt;
</pre>

<h4 id="get_reports">get_reports</h4>

<p>
The client uses the get_reports command to request reports.  This command
may include a report ID, format, first result number, maximum result count,
sort order, sort field, level contraint, search phrase, minimum CVSS base
constraint, notes flag, note details flag, overrides flag, override details
flag and result hosts only flag.
</p>

<p>
If there was no error with the command sent by the client, the manager will
reply with a response code indicating success and the report.  If the report
format is a binary format, the report will be in Base64 encoding.
</p>

<p>
Command attributes:
<ul>
  <li>"report_id" is the ID of the report which should be retrieved.</li>
  <li>"format" is a string describing the requested format.</li>
  <li>"first_result" is an integer.</li>
  <li>"max_results" is an integer.</li>
  <li>"sort_order" is "descending" for descending, anything else for ascending.
  <li>"sort_field" is the field to sort on.
  <li>"level" is a string that may include the characters h, m, l, g and d.</li>
  <li>"search_phrase" is a text phrase.</li>
  <li>"min_cvss_base" is a number.</li>
  <li>"notes" is boolean (0 is false, anything else is true).</li>
  <li>"notes_details" is boolean (0 is false, anything else is true).</li>
  <li>"overrides" is boolean (0 is false, anything else is true).</li>
  <li>"overrides_details" is boolean (0 is false, anything else is true).</li>
  <li>"result_hosts_only" is boolean (0 is false, anything else is true).</li>
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_reports report_id="267a3405-e84a-47da-97b2-5fa0d2e8995e" format="PDF"/&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_reports_response status="200" status_text="OK"&gt;
  &lt;report id="f0fdf522-276d-4893-9274-fb8699dc2270"&gt;hsisn3qaVFhkjFRG4...&lt;/report&gt;
&lt;/get_reports_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_reports report_id="267a3405-e84a-47da-97b2-5fa0d2e8995e"/&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_reports_response status="200" status_text="OK"&gt;
  &lt;report id="f0fdf522-276d-4893-9274-fb8699dc2270"&gt;
    &lt;sort&gt;
      &lt;field&gt;
        type
        &lt;order&gt;descending&lt;/order&gt;
      &lt;/field&gt;
    &lt;/sort&gt;
    &lt;filters&gt;
      hmlgd
      &lt;phrase&gt;&lt;/phrase&gt;
      &lt;notes&gt;0&lt;/notes&gt;
      &lt;overrides&gt;0&lt;/overrides&gt;
      &lt;apply_overrides&gt;0&lt;/apply_overrides&gt;
      &lt;result_hosts_only&gt;1&lt;/result_hosts_only&gt;
      &lt;min_cvss_base&gt;&lt;/min_cvss_base&gt;
      &lt;filter&gt;High&lt;/filter&gt;
      &lt;filter&gt;Medium&lt;/filter&gt;
      &lt;filter&gt;Low&lt;/filter&gt;
      &lt;filter&gt;Log&lt;/filter&gt;
      &lt;filter&gt;Debug&lt;/filter&gt;
    &lt;/filters&gt;
    &lt;scan_run_status&gt;Done&lt;/scan_run_status&gt;
    &lt;result_count&gt;
      10
      &lt;filtered&gt;10&lt;/filtered&gt;
      &lt;debug&gt;0&lt;/debug&gt;
      &lt;hole&gt;0&lt;/hole&gt;
      &lt;info&gt;7&lt;/info&gt;
      &lt;log&gt;0&lt;/log&gt;
      &lt;warning&gt;3&lt;/warning&gt;
    &lt;/result_count&gt;
    &lt;task id="13bb418a-4220-4575-b35b-ec398bff7417"&gt;
      &lt;name&gt;dik mm&lt;/name&gt;
    &lt;/task&gt;
    &lt;ports start="1" max="-1"&gt;
      &lt;port&gt;
        general/tcp
        &lt;host&gt;127.0.1.1&lt;/host&gt;
        &lt;threat&gt;Medium&lt;/threat&gt;
      &lt;/port&gt;
      ...
    &lt;/ports&gt;
    &lt;results start="1" max="-1"&gt;
      &lt;result id="634f7a2e-8ca1-43b7-b6d7-0d4841449508"&gt;
        &lt;subnet&gt;127.0.1.1&lt;/subnet&gt;
        &lt;host&gt;127.0.1.1&lt;/host&gt;
        &lt;port&gt;general/tcp&lt;/port&gt;
        &lt;nvt oid="1.3.6.1.4.1.25623.1.0.74"&gt;
          &lt;name&gt;Test NVT: fields with ISO-8859-1 chars ()&lt;/name&gt;
          &lt;cvss_base&gt;5.0&lt;/cvss_base&gt;
          &lt;risk_factor&gt;Medium&lt;/risk_factor&gt;
        &lt;/nvt&gt;
        &lt;threat&gt;Medium&lt;/threat&gt;
        &lt;description&gt;Test with  umlaut Warning Port 0.&lt;/description&gt;
      &lt;/result&gt;
      ...
    &lt;/results&gt;
    &lt;scan_start&gt;Mon Feb  1 19:11:21 2010&lt;/scan_start&gt;
    &lt;host_start&gt;Mon Feb  1 19:11:21 2010&lt;host&gt;127.0.1.1&lt;/host&gt;&lt;/host_start&gt;
    &lt;host_end&gt;Mon Feb  1 19:11:52 2010&lt;host&gt;127.0.1.1&lt;/host&gt;&lt;/host_end&gt;
    &lt;scan_end&gt;Mon Feb  1 19:11:52 2010&lt;/scan_end&gt;
  &lt;/report&gt;
&lt;/get_reports_response&gt;
</pre>

<h4 id="get_results">get_results</h4>

<p>
The client uses the get_results command to get result information. This command
may include the ID of an existing result, a task ID, a notes flag, a
notes_details flag, an overrides flag, an overrides_details flag and an
apply_overrides flag.
</p>

<p>
If the request includes a notes flag, an overrides flag or an apply_overrides
flag and any of these is true, then the request must also include a task ID.
</p>

<p>
If there was no error with the command sent by the client, the manager will
reply with a list of results to the client.
</p>

<p>
Command attributes:
<ul>
  <li>"result_id" is the ID of a result.</li>
  <li>"task_id" is the ID of a task.</li>
  <li>"notes" is boolean (0 is false, anything else is true).</li>
  <li>"notes_details" is boolean (0 is false, anything else is true).</li>
  <li>"overrides" is boolean (0 is false, anything else is true).</li>
  <li>"overrides_details" is boolean (0 is false, anything else is true).</li>
  <li>"apply_overrides" is boolean (0 is false, anything else is true).</li>
</ul>
</p>

<h5>Examples:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_results /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_results_response status="200" status_text="OK"&gt;
  &lt;results&gt;
    &lt;result id="634f7a2e-8ca1-43b7-b6d7-0d4841449508"&gt;
      &lt;subnet&gt;127.0.1.1&lt;/subnet&gt;
      &lt;host&gt;127.0.1.1&lt;/host&gt;
      &lt;port&gt;general/tcp&lt;/port&gt;
      &lt;nvt oid="1.3.6.1.4.1.25623.1.0.74"&gt;
        &lt;name&gt;Test NVT: fields with ISO-8859-1 chars&lt;/name&gt;
        &lt;cvss_base&gt;5.0&lt;/cvss_base&gt;
        &lt;risk_factor&gt;Medium&lt;/risk_factor&gt;
      &lt;/nvt&gt;
      &lt;threat&gt;Medium&lt;/threat&gt;
      &lt;description&gt;Test with umlaut.&lt;/description&gt;
    &lt;/result&gt;
    ...
  &lt;/results&gt;
&lt;/get_results_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_results result_id="cac9e7c8-c726-49fd-a710-5f99079ab93e"
             task_id="40b236a9-2b0f-4813-b8c7-bc2b98d9d7e4"
             notes="1"
             overrides="1" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_results_response status="200" status_text="OK"&gt;
  &lt;results&gt;
    &lt;result id="cac9e7c8-c726-49fd-a710-5f99079ab93e"&gt;
      &lt;subnet&gt;127.0.0.1&lt;/subnet&gt;
      &lt;host&gt;127.0.0.1&lt;/host&gt;
      &lt;port&gt;general/tcp&lt;/port&gt;
      &lt;nvt oid="1.3.6.1.4.1.25623.1.0.75"&gt;
        &lt;name&gt;Test NVT: long lines&lt;/name&gt;
        &lt;cvss_base&gt;9&lt;/cvss_base&gt;
        &lt;risk_factor&gt;High&lt;/risk_factor&gt;
      &lt;/nvt&gt;
      &lt;threat&gt;High&lt;/threat&gt;
      &lt;description&gt;Test with very long warning.&lt;/description&gt;
      &lt;original_threat&gt;Medium&lt;/original_threat&gt;
      &lt;notes&gt;&lt;/notes&gt;
      &lt;overrides&gt;
        &lt;override id="b0832812-75f1-45eb-b676-99c6e6bf2b24"&gt;
          &lt;nvt oid="1.3.6.1.4.1.25623.1.0.75"&gt;
            &lt;name&gt;Test NVT: long lines&lt;/name&gt;
          &lt;/nvt&gt;
          &lt;text excerpt="0"&gt;Test override&lt;/text&gt;
          &lt;new_threat&gt;High&lt;/new_threat&gt;
          &lt;orphan&gt;0&lt;/orphan&gt;
        &lt;/override&gt;
      &lt;/overrides&gt;
    &lt;/result&gt;
  &lt;/results&gt;
&lt;/get_results_response&gt;
</pre>

<h4 id="get_schedules">get_schedules</h4>

<p>
The client uses the get_schedules command to get schedule information. This command may
include the ID of an existing schedule, a details flag, a sort order and a sort field.
</p>

<p>
If there was no error with the command sent by the client, the manager will
reply with a list of schedules to the client.
</p>

<p>
Command attributes:
<ul>
  <li>"schedule_id" is the ID of a schedule.</li>
  <li>"details" is boolean (0 is false, anything else is true).</li>
  <li>"sort_order" is "descending" for descending, anything else for ascending.</li>
  <li>"sort_field" is the field to sort on.</li>
</ul>
</p>

<h5>Examples:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_schedules /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_schedules_response status="200" status_text="OK"&gt;
  &lt;schedule id="c33864a9-d3fd-44b3-8717-972bfb01dfcf"&gt;
    &lt;name&gt;Overnight&lt;/name&gt;
  &lt;/schedule&gt;
  ...
&lt;/get_schedules_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_schedules schedule_id="c33864a9-d3fd-44b3-8717-972bfb01dfcf" details="1"/&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_schedules_response status="200" status_text="OK"&gt;
  &lt;schedule id="c33864a9-d3fd-44b3-8717-972bfb01dfcf"&gt;
    &lt;name&gt;Overnight&lt;/name&gt;
    &lt;comment&gt;3 hours, starting at 12h00.&lt;/comment&gt;
    &lt;first_time&gt;Tue Jun 29 00:00:00 2010&lt;/first_time&gt;
    &lt;next_time&gt;Tue Jun 29 00:00:00 2010&lt;/next_time&gt;
    &lt;period&gt;86400&lt;/period&gt;
    &lt;period_months&gt;0&lt;/period_months&gt;
    &lt;duration&gt;10800&lt;/duration&gt;
    &lt;in_use&gt;1&lt;/in_use&gt;
    &lt;tasks&gt;
      &lt;task id="d4daf4c4-25c7-40ac-87d3-38e489f34330"&gt;
        &lt;name&gt;kk&lt;/name&gt;
      &lt;/task&gt;
    &lt;/tasks&gt;
  &lt;/schedule&gt;
&lt;/get_schedules_response&gt;
</pre>

<h4 id="get_system_reports">get_system_reports</h4>

<p>
The client uses the get_system_reports command to get system reports.  This
command may include a name, a duration and a brief flag.
</p>

<p>
If there was no error with the command sent by the client, the manager will
reply with the system reports to the client.
</p>

<p>
Command attributes:
<ul>
  <li>"name" is a string describing the requested report.</li>
  <li>"duration" is a number of seconds.</li>
  <li>"brief" is boolean (0 is false, anything else is true).</li>
</ul>
</p>

<h5>Examples:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_system_reports brief="1" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_system_reports_response status="200" status_text="OK"&gt;
  &lt;system_report&gt;
    &lt;name&gt;proc&lt;/name&gt;
    &lt;title&gt;Processes&lt;/title&gt;
  &lt;/system_report&gt;
  &lt;system_report&gt;
    &lt;name&gt;load&lt;/name&gt;
    &lt;title&gt;System Load&lt;/title&gt;
  &lt;/system_report&gt;
  &lt;system_report&gt;
    &lt;name&gt;cpu_0&lt;/name&gt;
    &lt;title&gt;CPU Usage: CPU 0&lt;/title&gt;
  &lt;/system_report&gt;
&lt;/get_system_reports_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_system_reports name="proc" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_system_reports_response status="200" status_text="OK"&gt;
  &lt;system_report&gt;
    &lt;name&gt;proc&lt;/name&gt;
    &lt;title&gt;Processes&lt;/title&gt;
    &lt;report format="png" duration="86400"&gt;
      iVBORw0KGgoAAAANSUhEUgAAArkAAAEMCAYAAADAsa7vAAAABmJLR0QA/wD/AP+gvaeTAAAAB3RJ
      TUUH2gYbDCUmRM0cqQAAIABJREFUeJzsnXl4FFW+/t9mGRFpAiRsIZCEsIhJQAZRBAxpAoERh6DX
      ...
      JYQQol9Xr16Fg4PDhHdwpVeap0+frtMpegkhRF3UySWEkEksMDBQL/uloQiEEENHb1cghBBCCCFT
      DnVyCSGEEELIlEOdXEIIIYQQMuVwbt++PSoWi3Hv3j19l4UQQgghhBCtMKIOLiGEEEIImWr+B9Md
      9A602bEdAAAAAElFTkSuQmCC
    &lt;/report&gt;
  &lt;/system_report&gt;
&lt;/get_system_reports_response&gt;
</pre>

<h4 id="get_target_locators">get_target_locators</h4>

<p>
The client uses the get_target_locators command to get target locator
information.
</p>

<p>
If there was no error with the command sent by the client, the manager will
reply with a list of target locators to the client.
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Examples:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_target_locators /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_target_locators_response status="200" status_text="OK"&gt;
  &lt;target_locator&gt;
    &lt;name&gt;ldap&lt;/name&gt;
  &lt;/target_locator&gt;
  ...
&lt;/get_target_locators_response&gt;
</pre>

<h4 id="get_targets">get_targets</h4>

<p>
The client uses the get_targets command to get target information. This command
may include the ID of an existing target, a tasks flag, a sort order and a sort
field.
</p>

<p>
If there was no error with the command sent by the client, the manager will
reply with a list of targets to the client.
</p>

<p>
Command attributes:
<ul>
  <li>"target_id" is the ID of a target.
  <li>"tasks" is boolean (0 is false, anything else is true).</li>
  <li>"sort_order" is "descending" for descending, anything else for ascending.
  <li>"sort_field" is the field to sort on.
</ul>
</p>

<h5>Examples:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_targets /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_targets_response status="200" status_text="OK"&gt;
  &lt;target id="b493b7a8-7489-11df-a3ec-002264764cea"&gt;
    &lt;name&gt;Localhost&lt;/name&gt;
    &lt;hosts&gt;localhost&lt;/hosts&gt;
    &lt;max_hosts&gt;1&lt;/max_hosts&gt;
    &lt;comment&gt;&lt;/comment&gt;
    &lt;in_use&gt;7&lt;/in_use&gt;
    &lt;lsc_credential id=""&gt;
      &lt;name&gt;&lt;/name&gt;
    &lt;/lsc_credential&gt;
  &lt;/target&gt;
  ...
&lt;/get_targets_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_targets target_id="c33864a9-d3fd-44b3-8717-972bfb01dfcf" tasks="1" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_targets_response status="200" status_text="OK"&gt;
  &lt;target id="1f28d970-17ef-4c69-ba8a-13827059f2b9"&gt;
    &lt;name&gt;dik&lt;/name&gt;
    &lt;hosts&gt;dik.example.org&lt;/hosts&gt;
    &lt;max_hosts&gt;1&lt;/max_hosts&gt;
    &lt;comment&gt;dik mm&lt;/comment&gt;
    &lt;in_use&gt;4&lt;/in_use&gt;
    &lt;lsc_credential id="58ff2793-2dc7-43fe-85f9-20bfac5a87e4"&gt;
      &lt;name&gt;mm&lt;/name&gt;
    &lt;/lsc_credential&gt;
    &lt;tasks&gt;
      &lt;task id="13bb418a-4220-4575-b35b-ec398bff7417"&gt;
        &lt;name&gt;dik mm&lt;/name&gt;
      &lt;/task&gt;
      ...
    &lt;/tasks&gt;
  &lt;/target&gt;
&lt;/get_targets_response&gt;
</pre>

<h4 id="get_tasks">get_tasks</h4>

<p>
The client uses the get_tasks command to request task information.  This command
may include a task ID, details flag, apply overrides flag, sort order and sort
field,
</p>

<p>
If the command includes the details flag each task will include details of all
reports on the task.
</p>

<p>
As a convenience for clients the response includes a task count and the values
of the sort order, sort field and apply overrides flag that the manager applied
when selecting the tasks.
</p>

<p>
Command attributes:
<ul>
  <li>"task_id" is the ID of the task which should be queried.</li>
  <li>"details" is boolean (0 is false, anything else is true).</li>
  <li>"apply_overrides" is boolean (0 is false, anything else is true).</li>
  <li>"sort_order" is "descending" for descending, anything else for ascending.</li>
  <li>"sort_field" is the field to sort on.</li>
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_tasks /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_tasks_response status="200" status_text="OK"&gt;
  &lt;task_count&gt;2&lt;/task_count&gt;
  &lt;sort&gt;
    &lt;field&gt;
      ROWID
      &lt;order&gt;ascending&lt;/order&gt;
    &lt;/field&gt;
  &lt;/sort&gt;
  &lt;apply_overrides&gt;0&lt;/apply_overrides&gt;
  &lt;task id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6"&gt;
    &lt;name&gt;Scan Webserver&lt;/name&gt;
    &lt;comment&gt;Scan of the web server.&lt;/name&gt;
    &lt;status&gt;Done&lt;/status&gt;
    &lt;progress&gt;-1&lt;/progress&gt;
    &lt;config id="daba56c8-73ec-11df-a475-002264764cea"&gt;
      &lt;name&gt;Full and fast&lt;/name&gt;
    &lt;/config&gt;
    &lt;escalator id=""&gt;
      &lt;name&gt;&lt;/name&gt;
    &lt;/escalator&gt;
    &lt;target id="1f28d970-17ef-4c69-ba8a-13827059f2b9"&gt;
      &lt;name&gt;dik&lt;/name&gt;
    &lt;/target&gt;
    &lt;schedule id=""&gt;
      &lt;name&gt;&lt;/name&gt;
      &lt;next_time&gt;over&lt;/next_time&gt;
    &lt;/schedule&gt;
    &lt;result_count&gt;
      &lt;debug&gt;0&lt;/debug&gt;
      &lt;log&gt;0&lt;/log&gt;
      &lt;info&gt;14&lt;/info&gt;
      &lt;warning&gt;0&lt;/warning&gt;
      &lt;hole&gt;6&lt;/hole&gt;
    &lt;/result_count&gt;
    &lt;report_count&gt;
      2
      &lt;finished&gt;2&lt;/finished&gt;
    &lt;/report_count&gt;
    &lt;trend&gt;&lt;/trend&gt;
    &lt;first_report&gt;
      &lt;report id="f0fdf522-276d-4893-9274-fb8699dc2270"&gt;
        &lt;timestamp&gt;Mon Feb  1 19:11:20 2010&lt;/timestamp&gt;
        &lt;result_count&gt;
          &lt;debug&gt;0&lt;/debug&gt;
          &lt;hole&gt;0&lt;/hole&gt;
          &lt;info&gt;7&lt;/info&gt;
          &lt;log&gt;0&lt;/log&gt;
          &lt;warning&gt;3&lt;/warning&gt;
        &lt;/result_count&gt;
      &lt;/report&gt;
    &lt;/first_report&gt;
    &lt;last_report&gt;
      &lt;report id="f0fdf522-276d-4893-9274-fb8699dc2270"&gt;
        &lt;timestamp&gt;Mon Feb  1 19:11:20 2010&lt;/timestamp&gt;
        &lt;result_count&gt;
          &lt;debug&gt;0&lt;/debug&gt;
          &lt;hole&gt;0&lt;/hole&gt;
          &lt;info&gt;7&lt;/info&gt;
          &lt;log&gt;0&lt;/log&gt;
          &lt;warning&gt;3&lt;/warning&gt;
        &lt;/result_count&gt;
      &lt;/report&gt;
    &lt;/last_report&gt;
  &lt;/task&gt;
  &lt;task id="f14747d3-a4d7-4e79-99bb-a0a1276cb78c"&gt;
    &lt;name&gt;Scan Mailserver&lt;/name&gt;
    ...
  &lt;/task&gt;
&lt;/get_tasks_response&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_tasks task_id="f14747d3-a4d7-4e79-99bb-a0a1276cb78c" details="1" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_tasks_response status="200" status_text="OK"&gt;
  &lt;task_count&gt;1&lt;/task_count&gt;
  &lt;sort&gt;
    &lt;field&gt;
      ROWID
      &lt;order&gt;ascending&lt;/order&gt;
    &lt;/field&gt;
  &lt;/sort&gt;
  &lt;apply_overrides&gt;0&lt;/apply_overrides&gt;
  &lt;task id="13bb418a-4220-4575-b35b-ec398bff7417"&gt;
    &lt;name&gt;Scan Mailserver&lt;/name&gt;
    &lt;comment&gt;Scan of the web server.&lt;/name&gt;
    &lt;status&gt;Done&lt;/status&gt;
    &lt;progress&gt;-1&lt;/progress&gt;
    &lt;config id="daba56c8-73ec-11df-a475-002264764cea"&gt;
      &lt;name&gt;Full and fast&lt;/name&gt;
    &lt;/config&gt;
    &lt;escalator id=""&gt;
      &lt;name&gt;&lt;/name&gt;
    &lt;/escalator&gt;
    &lt;target id="1f28d970-17ef-4c69-ba8a-13827059f2b9"&gt;
      &lt;name&gt;dik&lt;/name&gt;
    &lt;/target&gt;
    &lt;schedule id=""&gt;
      &lt;name&gt;&lt;/name&gt;
      &lt;next_time&gt;over&lt;/next_time&gt;
    &lt;/schedule&gt;
    &lt;result_count&gt;
      &lt;debug&gt;0&lt;/debug&gt;
      &lt;log&gt;0&lt;/log&gt;
      &lt;info&gt;14&lt;/info&gt;
      &lt;warning&gt;0&lt;/warning&gt;
      &lt;hole&gt;6&lt;/hole&gt;
    &lt;/result_count&gt;
    &lt;report_count&gt;
      2
      &lt;finished&gt;2&lt;/finished&gt;
    &lt;/report_count&gt;
    &lt;trend&gt;&lt;/trend&gt;
    &lt;first_report&gt;
      &lt;report id="f0fdf522-276d-4893-9274-fb8699dc2270"&gt;
        &lt;timestamp&gt;Mon Feb  1 19:11:20 2010&lt;/timestamp&gt;
        &lt;result_count&gt;
          &lt;debug&gt;0&lt;/debug&gt;
          &lt;hole&gt;0&lt;/hole&gt;
          &lt;info&gt;7&lt;/info&gt;
          &lt;log&gt;0&lt;/log&gt;
          &lt;warning&gt;3&lt;/warning&gt;
        &lt;/result_count&gt;
      &lt;/report&gt;
    &lt;/first_report&gt;
    &lt;last_report&gt;
      &lt;report id="2688e6c7-db29-4505-80f1-0fd4a09e1011"&gt;
        &lt;timestamp&gt;Mon Feb  1 19:11:20 2010&lt;/timestamp&gt;
        &lt;result_count&gt;
          &lt;debug&gt;0&lt;/debug&gt;
          &lt;hole&gt;0&lt;/hole&gt;
          &lt;info&gt;7&lt;/info&gt;
          &lt;log&gt;0&lt;/log&gt;
          &lt;warning&gt;3&lt;/warning&gt;
        &lt;/result_count&gt;
      &lt;/report&gt;
    &lt;/last_report&gt;
    &lt;reports&gt;
      &lt;report id="f0fdf522-276d-4893-9274-fb8699dc2270"&gt;
        &lt;timestamp&gt;Mon Feb  1 18:51:38 2010&lt;/timestamp&gt;
        &lt;scan_run_status&gt;Done&lt;/scan_run_status&gt;
        &lt;result_count&gt;
          &lt;debug&gt;0&lt;/debug&gt;
          &lt;hole&gt;0&lt;/hole&gt;
          &lt;info&gt;7&lt;/info&gt;
          &lt;log&gt;0&lt;/log&gt;
          &lt;warning&gt;3&lt;/warning&gt;
        &lt;/result_count&gt;
      &lt;/report&gt;
      &lt;report id="2688e6c7-db29-4505-80f1-0fd4a09e1011"&gt;
        &lt;timestamp&gt;Mon Feb  1 19:11:20 2010&lt;/timestamp&gt;
        &lt;scan_run_status&gt;Done&lt;/scan_run_status&gt;
        &lt;result_count&gt;
          &lt;debug&gt;0&lt;/debug&gt;
          &lt;hole&gt;0&lt;/hole&gt;
          &lt;info&gt;7&lt;/info&gt;
          &lt;log&gt;0&lt;/log&gt;
          &lt;warning&gt;3&lt;/warning&gt;
        &lt;/result_count&gt;
      &lt;/report&gt;
    &lt;/reports&gt;
  &lt;/task&gt;
&lt;/get_tasks_response&gt;
</pre>

<h4 id="get_version">get_version</h4>

<p>
The client uses the get_version command to request the protocol version
which may be used when communicating with this manager.  The manager will reply
with a response code indicating success and the version.
</p>

<p>
The client is advised to use this command before using any other command.
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;get_version/&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;get_version_response status="200" status_text="OK"&gt;
  &lt;version&gt;1.5&lt;/version&gt;
&lt;/get_version_response&gt;
</pre>

<h4 id="help">help</h4>

<p>
The help command requests a human-readable description of the available OMP
commands.  The manager will reply with a response code indicating success
and a textual description of all commands.
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;help/&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;help_response status="200" status_text="OK"&gt;
    AUTHENTICATE           Authenticate with the manager.
    COMMANDS               Run a list of commands.
    CREATE_AGENT           Create an agent.
    CREATE_CONFIG          Create a config.
    CREATE_ESCALATOR       Create an escalator.
    CREATE_LSC_CREDENTIAL  Create a local security check credential.
    CREATE_NOTE            Create a note.
    CREATE_OVERRIDE        Create an override.
    CREATE_SCHEDULE        Create a schedule.
    CREATE_TARGET          Create a target.
    CREATE_TASK            Create a task.
    DELETE_AGENT           Delete an agent.
    DELETE_CONFIG          Delete a config.
    DELETE_ESCALATOR       Delete an escalator.
    DELETE_LSC_CREDENTIAL  Delete a local security check credential.
    DELETE_NOTE            Delete a note.
    DELETE_OVERRIDE        Delete an override.
    DELETE_REPORT          Delete a report.
    DELETE_SCHEDULE        Delete a schedule.
    DELETE_TARGET          Delete a target.
    DELETE_TASK            Delete a task.
    GET_AGENTS             Get all agents.
m4_dnl    GET_CERTIFICATES       Get all available certificates.
    GET_CONFIGS            Get all configs.
    GET_DEPENDENCIES       Get dependencies for all available NVTs.
    GET_ESCALATORS         Get all escalators.
    GET_LSC_CREDENTIALS    Get all local security check credentials.
    GET_NOTES              Get all notes.
    GET_NVTS               Get one or all available NVTs.
    GET_NVT_FAMILIES       Get a list of all NVT families.
    GET_NVT_FEED_CHECKSUM  Get checksum for entire NVT collection.
    GET_OVERRIDES          Get all overrides.
    GET_PREFERENCES        Get preferences for all available NVTs.
    GET_REPORTS            Get all reports.
    GET_RESULTS            Get results.
    GET_SCHEDULES          Get all schedules.
    GET_SYSTEM_REPORTS     Get all system reports.
    GET_TARGET_LOCATORS    Get configured target locators.
    GET_TARGETS            Get all targets.
    GET_TASKS              Get all tasks.
    GET_VERSION            Get the OpenVAS Manager Protocol version.
    HELP                   Get this help text.
    MODIFY_CONFIG          Update an existing config.
    MODIFY_NOTE            Modify an existing note.
    MODIFY_OVERRIDE        Modify an existing override.
    MODIFY_REPORT          Modify an existing report.
    MODIFY_TASK            Update an existing task.
    PAUSE_TASK             Pause a running task.
    RESUME_OR_START_TASK   Resume task if stopped, else start task.
    RESUME_PAUSED_TASK     Resume a paused task.
    RESUME_STOPPED_TASK    Resume a stopped task.
    START_TASK             Manually start an existing task.
    STOP_TASK              Stop a running task.
    TEST_ESCALATOR         Run an escalator.
&lt;/help_response&gt;
</pre>

<h4 id="modify_config">modify_config</h4>

<p>
The client uses the modify_config command to change an existing config.  This
command must include the ID of an existing config and either a preference,
an NVT selection or a family selection.
</p>

<p>
The first option, a preference, must include a name.
If the preference includes an NVT, then the preference is an NVT preference,
otherwise the preference is a Scanner preference.  If the preference includes
a value then the manager updates the value of the preference, otherwise the
manager removes the preference.
</p>

<p>
The second option, a family selection, lets the client modify the NVTs selected
by the config at a family level.  The idea is that the client modifies the
entire family selection at once, so a client will often need to include many
families in a family selection.
</p>

<p>
The family_selection may include a growing element to indicate whether new
families should be added to the selection.  It may also include any number
of family elements.
</p>

<p>
A family element must always include a name and may include a growing element
and an all element.  The all element indicates whether all NVTs in the family
should be selected.  The growing element indicates whether new NVTs in the
family should be added to the selection as they arrive.  Leaving a family
out of the family_selection is equivalent to including the family with all
0 and growing 0.
</p>

<p>
The effect of the all 0 and growing 0 case is subtle: if
all NVTs were selected then all are removed (effectively removing the
family from the config).  However if some NVTs were selected then they
remain selected.  As a result the client must include in the
family_selection all families that must have all NVTs selected.
</p>

<p>
The third option, an NVT selection, must include a family and may include any
number of NVTs.  The manager updates the given family in the config to
include only the given NVTs.
</p>

<p>
If there was no error with the command sent by the client, the manager will
apply the changes to the config and will reply with a response code indicating
success.
</p>

<p>
Command attributes:
<ul>
  <li>"config_id" is the ID of the config which should be changed.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>
    &lt;preference&gt;
    <ul>
m4_dnl TODO should have separate type element
      <li>&lt;name&gt; is the name of a preference.  This is OpenVAS Scanner
          style, including the NVT name and preference type, for example
          "LDAPsearch[entry]:Timeout value".
      <li>&lt;nvt&gt; is an empty element with an oid attribute.</li>
m4_dnl TODO b64 for get_config preferences?  how will simple clients handle this?
      <li>&lt;value&gt; is the new value of the preference, Base64 encoded.
    </ul>
  </li>
  <li>
    &lt;family_selection&gt;
    <ul>
      <li>&lt;growing&gt; is boolean (after C atoi conversion, 0 is false, anything else is true).</li>
      <li>
        &lt;family&gt;
        <ul>
          <li>&lt;all&gt; is boolean (after C atoi conversion, 0 is false, anything else is true).</li>
          <li>&lt;growing&gt; is boolean (after C atoi conversion, 0 is false, anything else is true).</li>
          <li>&lt;name&gt; is the name of an NVT family.</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>
    &lt;nvt_selection&gt;
    <ul>
      <li>&lt;family&gt; is the name of an NVT family</li>
      <li>&lt;nvt&gt; is an empty element with an oid attribute.</li>
    </ul>
  </li>
</ul>
</p>

<h5>Examples:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;modify_config config_id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6"&gt;
  &lt;preference&gt;
    &lt;nvt oid="1.3.6.1.4.1.25623.1.0.14259"/&gt;
    &lt;name&gt;Nmap (NASL wrapper)[checkbox]:UDP port scan&lt;/name&gt;
    &lt;value&gt;eWVz&lt;/value&gt;
  &lt;/preference&gt;
&lt;/modify_config&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_config_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_config_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_config_response status="500" status_text="Internal error" /&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;modify_config config_id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6"&gt;
  &lt;family_selection&gt;
    &lt;!-- Set the config to add any new families that arrive. --&gt;
    &lt;growing&gt;1&lt;/growing&gt;
    &lt;!-- Keep the single family that has all NVTs selected --&gt;
    &lt;family&gt;
      &lt;name&gt;Debian Local Security Checks&lt;/name&gt;
      &lt;all&gt;1&lt;/all&gt;
      &lt;growing&gt;1&lt;/growing&gt;
    &lt;/family&gt;
  &lt;/family_selection&gt;
&lt;/modify_config&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_config_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_config_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_config_response status="500" status_text="Internal error" /&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;modify_config config_id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6"&gt;
  &lt;family_selection&gt;
    &lt;!-- Keep the single family that has all NVTs selected --&gt;
    &lt;family&gt;
      &lt;name&gt;Debian Local Security Checks&lt;/name&gt;
      &lt;all&gt;1&lt;/all&gt;
      &lt;growing&gt;1&lt;/growing&gt;
    &lt;/family&gt;
    &lt;!-- Switch a family to receive any new NVTs that arrive. --&gt;
    &lt;family&gt;
      &lt;name&gt;General&lt;/name&gt;
      &lt;growing&gt;1&lt;/growing&gt;
    &lt;/family&gt;
  &lt;/family_selection&gt;
&lt;/modify_config&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_config_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_config_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_config_response status="500" status_text="Internal error" /&gt;
</pre>

<p>
<b>C:</b>
</p>

<pre>
&lt;modify_config config_id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6"&gt;
  &lt;nvt_selection&gt;
    &lt;family&gt;Debian Local Security Checks&lt;/family&gt;
    &lt;nvt oid="1.3.6.1.4.1.25623.1.0.53797"/&gt;
    &lt;nvt oid="1.3.6.1.4.1.25623.1.0.63272"/&gt;
    &lt;nvt oid="1.3.6.1.4.1.25623.1.0.55615"/&gt;
    &lt;nvt oid="1.3.6.1.4.1.25623.1.0.53546"/&gt;
  &lt;/nvt_selection&gt;
&lt;/modify_config&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_config_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_config_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_config_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="modify_note">modify_note</h4>

<p>
The client uses the modify_note command to change an existing note.  This
command must include the ID of an existing note and the note text.
This command may include a host list, port, threat, task and result.
</p>

<p>
If an optional element is left out, the existing value will be cleared,
generalising that constraint.
</p>

<p>
If there was no error with the command sent by the client, the manager will
apply the changes to the note and will reply with a response code indicating
success.
</p>

<p>
Command attributes:
<ul>
  <li>"note_id" is the ID of the note which should be changed.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>&lt;text&gt; is a human-readable text.
  <li>&lt;hosts&gt; is a textual list of hosts.
  <li>&lt;port&gt; is a port.
  <li>&lt;threat&gt; is a threat.
  <li>&lt;task&gt; is an empty element with an id attribute.
  <li>&lt;result&gt; is an empty element with an id attribute.
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;modify_note note_id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6"&gt;
  &lt;text&gt;This issue should be resolved after the upgrade.&lt;/text&gt;
  &lt;result id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6"/&gt;
&lt;/modify_note&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_note_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_note_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_note_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="modify_override">modify_override</h4>

<p>
The client uses the modify_override command to change an existing override.
This command must include the ID of an existing override and the override text.
This command may include a host list, port, new threat, threat, task and result.
</p>

<p>
If an optional element is left out, the existing value will be cleared,
generalising that constraint.
</p>

<p>
If there was no error with the command sent by the client, the manager will
apply the changes to the override and will reply with a response code indicating
success.
</p>

<p>
Command attributes:
<ul>
  <li>"override_id" is the ID of the override which should be changed.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>&lt;text&gt; is a human-readable text.
  <li>&lt;hosts&gt; is a textual list of hosts.
  <li>&lt;new_threat&gt; is a threat.
  <li>&lt;port&gt; is a port.
  <li>&lt;threat&gt; is a threat.
  <li>&lt;task&gt; is an empty element with an id attribute.
  <li>&lt;result&gt; is an empty element with an id attribute.
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;modify_override override_id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6"&gt;
  &lt;text&gt;This issue is less important in our setup.&lt;/text&gt;
  &lt;new_threat&gt;Low&lt;/new_threat&gt;
&lt;/modify_override&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_override_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_override_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_override_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="modify_report">modify_report</h4>

<p>
The client uses the modify_report command to modify an existing report.
This command must include the ID of an existing report and a comment.
</p>

<p>
If there was no error with the command sent by the client, the manager will
add the comment to the report and will reply with a response code indicating
success.
</p>

<p>
Command attributes:
<ul>
  <li>"report_id" is the ID of the report which should be modified.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>&lt;comment&gt; is the new text for the comment.</li>
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;modify_report report_id="65defe9b-bb28-4e85-9ed7-3f2a57ac8263"&gt;
  &lt;comment&gt;This is the report where vulnerability XYZ was found on our Webserver.&lt;/comment&gt;
&lt;/modify_report&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_report_response status="200" status_text="OK" /&gt;
</pre>

<h4 id="modify_task">modify_task</h4>

<p>
The client uses the modify_task command to change an existing task.  This
m4_dnl TODO "either include" is actually "include one or more of" in manager
command must include the ID of an existing task and must either include
a name, a comment, an escalator, a schedule, an rcfile or a file.
</p>

<p>
If there was no error with the command sent by the client, the manager will
apply the changes to the task and will reply with a response code indicating
success.
</p>

<p>
Command attributes:
<ul>
  <li>"task_id" is the ID of the task which should be changed.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>&lt;rcfile&gt; is a file describing the task. As of OMP 1.0, this file is
in the openvasrc format.  The file must be Base64 encoded.
  <li>&lt;name&gt; is a human-readable identifier.
  <li>&lt;comment&gt; is a human-readable text.
  <li>&lt;escalator&gt; is an empty element with an id attribute.
  <li>&lt;schedule&gt; is an empty element with an id attribute.
  <li>&lt;file&gt; is the text of a file, with name and action attributes.  The
      file must be Base64 encoded.  Name is the name the manager associates with
      the file.  Action must be either "update" or "remove".</li>
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;modify_task task_id="254cd3ef-bbe1-4d58-859d-21b8d0c046c6"&gt;
  &lt;comment&gt;Monthly scan of the webserver&lt;/comment&gt;
&lt;/modify_task&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_task_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_task_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;modify_task_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="pause_task">pause_task</h4>

<p>
The client uses the pause_task command to manually pause an existing task. This
command must include the ID of an existing task.
</p>

<p>
If there was no error with the command sent by the client, the manager will
pause the task and will reply with a response code indicating success.
</p>

<p>
Command attributes:
<ul>
  <li>"task_id" is the ID of the task which should be paused.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;pause_task task_id="825a5d10-24b2-4473-a4e0-55f8cfd4bf23" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;pause_task_response status="201" status_text="OK, resource created" task_id="825a5d10-24b2-4473-a4e0-55f8cfd4bf23" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;pause_task_response status="4xx" task_id="825a5d10-24b2-4473-a4e0-55f8cfd4bf23" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;pause_task_response status="500" status_text="Internal error" task_id="825a5d10-24b2-4473-a4e0-55f8cfd4bf23" /&gt;
</pre>

<h4 id="resume_or_start_task">resume_or_start_task</h4>

<p>
The client uses the resume_or_start_task command to manually start an existing task,
ensuring that the task will resume from its previous position if the task is
in the Stopped state. This command must include the ID of an existing task.
</p>

<p>
If there was no error with the command sent by the client, the manager will
resume or start the task and will reply with a response code indicating success.
</p>

<p>
Command attributes:
<ul>
  <li>"task_id" is the ID of the task which should be resumed or started.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;resume_or_start_task task_id="825a5d10-24b2-4473-a4e0-55f8cfd4bf23" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;resume_or_start_task_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;resume_or_start_task_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;resume_or_start_task_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="resume_paused_task">resume_paused_task</h4>

<p>
The client uses the resume_paused_task command to manually resume a paused
task. This command must include the ID of an existing task.
</p>

<p>
If there was no error with the command sent by the client and if the task is
currently paused, the manager will resume the task and will reply with a response
code indicating success.
</p>

<p>
Command attributes:
<ul>
  <li>"task_id" is the ID of the task which should be resumed.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;resume_paused_task task_id="825a5d10-24b2-4473-a4e0-55f8cfd4bf23" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;resume_paused_task_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;resume_paused_task_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;resume_paused_task_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="resume_stopped_task">resume_stopped_task</h4>

<p>
The client uses the resume_stopped_task command to manually resume a stopped
task. This command must include the ID of an existing task.
</p>

<p>
If there was no error with the command sent by the client and if the task is
currently stopped, the manager will resume the task and will reply with a response
code indicating success.
</p>

<p>
Command attributes:
<ul>
  <li>"task_id" is the ID of the task which should be resumed.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;resume_stopped_task task_id="825a5d10-24b2-4473-a4e0-55f8cfd4bf23" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;resume_stopped_task_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;resume_stopped_task_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;resume_stopped_task_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="start_task">start_task</h4>

<p>
The client uses the start_task command to manually start an existing task. This
command must include the ID of an existing task.
</p>

<p>
If there was no error with the command sent by the client, the manager will
start the task and will reply with a response code indicating success.
</p>

<p>
Command attributes:
<ul>
  <li>"task_id" is the ID of the task which should be started.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;start_task task_id="825a5d10-24b2-4473-a4e0-55f8cfd4bf23" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;start_task_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;start_task_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;start_task_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="stop_task">stop_task</h4>

<p>
The client uses the stop_task command to manually stop a running task. This
command must include the ID of an existing task.
</p>

<p>
If there was no error with the command sent by the client, the manager will
stop the task and will reply with a response code.
</p>

<p>
Command attributes:
<ul>
  <li>"task_id" is the ID of the task which should be stopped.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;stop_task task_id="825a5d10-24b2-4473-a4e0-55f8cfd4bf23" /&lt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;stop_task_response status="201" status_text="OK" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;stop_task_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;stop_task_response status="500" status_text="Internal error" /&gt;
</pre>

<h4 id="test_escalator">test_escalator</h4>

<p>
The client uses the test_escalator command to invoke a test run of
an escalator.
</p>

<p>
If there was no error with the command sent by the client, the manager will
run the escalator and will reply with a response code indicating success.
</p>

<p>
Command attributes:
<ul>
  <li>"escalator_id" is the ID of the escalator which should be tested.
</ul>
</p>

<p>
Command elements:
<ul>
  <li>(n/a)
</ul>
</p>

<h5>Example:</h5>

<p>
<b>C:</b>
</p>

<pre>
&lt;test_escalator escalator_id="825a5d10-24b2-4473-a4e0-55f8cfd4bf23" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;test_escalator_response status="200" status_text="OK" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;test_escalator_response status="4xx" /&gt;
</pre>

<p>
<b>M:</b>
</p>

<pre>
&lt;test_escalator_response status="500" status_text="Internal error" /&gt;
</pre>

<h3>History</h3>

<ul>
<li> 2010-11-03 Matthew Mundell &lt;matthew.mundell@greenbone.net&gt;:<br>
     Correct CREATE_CONFIGS rcfile description.  Remove username and password
     from CREATE_TARGET target locator sentence.  Clean up brackets on
     CREATE_TASK.  Correct INSTALLER and add missing attribute in GET_AGENTS
     examples.  Correct GET_PREFERENCES examples, adding two more.  Correct
     MODIFY_NOTE example.  Cleanup MODIFY_NOTE example tags.
</li>
<li> 2010-10-12 Matthew Mundell &lt;matthew.mundell@greenbone.net&gt;:<br>
     Add examples and better explanations of the MODIFY_CONFIG alternatives,
     correcting the descriptions of the boolean elements.  </li>
<li> 2010-10-11 Matthew Mundell &lt;matthew.mundell@greenbone.net&gt;:<br>
     Cleanup GET_NVTS_RESPONSE brackets.  </li>
<li> 2010-10-04 Matthew Mundell &lt;matthew.mundell@greenbone.net&gt;:<br>
     Correct GET_REPORTS attribute names and the MODIFY_CONFIG example NAME
     and VALUE.  </li>
<li> 2010-07-20 Michael Wiegand &lt;michael.wiegand@greenbone.net&gt;:<br>
     Updated status.</li>
<li> 2010-07-16 Matthew Mundell &lt;matthew.mundell@greenbone.net&gt;:<br>
     In CREATE_CONFIG correct reference and add example.</li>
<li> 2010-07-14 Matthew Mundell &lt;matthew.mundell@greenbone.net&gt;:<br>
     Describe commands that can precede authentication.  Reduce GET_VERSION
     to a single fixed version.</li>
<li> 2010-07-13 Matthew Mundell &lt;matthew.mundell@greenbone.net&gt;:<br>
     Cleanup TODOs.</li>
<li> 2010-07-06 Matthew Mundell &lt;matthew.mundell@greenbone.net&gt;:<br>
     Add SIGNATURE to CREATE_AGENT/INSTALLER.  Add TRUST to GET_AGENTS
     response.</li>
<li> 2010-07-05 Matthew Mundell &lt;matthew.mundell@greenbone.net&gt;:<br>
     Add THREAT to GET_OVERRIDES brief example.</li>
<li> 2010-06-28 Matthew Mundell &lt;matthew.mundell@greenbone.net&gt;:<br>
     Comment out GET_CERTIFICATES.</li>
<li> 2010-06-27 Matthew Mundell &lt;matthew.mundell@greenbone.net&gt;:<br>
     Add missing get commands.  Bring remaining commands up to date.</li>
<li> 2010-06-22 Matthew Mundell &lt;matthew.mundell@greenbone.net&gt;:<br>
     Make UUID scheme permanent.  Update authentication to match Manager.
     Add a few new commands.  Remove IDs from fail cases of create commands.
     Remove ABORT_TASK criterion.  Update HELP.  Update renamed commands.
     Add all commands to index.  Add missing create and delete commands.</li>
<li> 2010-06-10 Matthew Mundell &lt;matthew.mundell@greenbone.net&gt;:<br>
     Update HELP text.
     Add a few new commands.
     Remove ABORT_TASK criterion.</li>
<li> 2009-06-10 Matthew Mundell &lt;matthew.mundell@intevation.de&gt;:<br>
	 Add IDs to HTML entities in command index.
     Remove ID from CREATE_TASK.  Rename CREATE_TASK's FILE to RCFILE.
     Add special entities to MODIFY_TASK.  Improve MODIFY_TASK example.
	 Move GET_NVT_ALL and GET_NVT_DETAILS OID entity to an attribute.
	 Separate attributes from command element lists.</li>
<li> 2009-06-04 Matthew Mundell &lt;matthew.mundell@intevation.de&gt;:<br>
     Add summary of commands, with links to detailed descriptions.</li>
<li> 2009-06-04 Matthew Mundell &lt;matthew.mundell@intevation.de&gt;:<br>
     Note get_nvt_feed_checksum behaviour when algorithm missing.</li>
<li> 2009-05-13 Matthew Mundell &lt;matthew.mundell@intevation.de&gt;:<br>
     Add task name and state to STATUS response when ID given.</li>
<li> 2009-05-11 Matthew Mundell &lt;matthew.mundell@intevation.de&gt;:<br>
     Added HELP command.</li>
<li> 2009-02-04 Michael Wiegand &lt;michael.wiegand@intevation.de&gt;:<br>
     Made command names more consistent.</li>
<li> 2009-01-29 Michael Wiegand &lt;michael.wiegand@intevation.de&gt;:<br>
     Updated protocol specification based on feedback received.</li>
<li> 2009-01-08 Michael Wiegand &lt;michael.wiegand@intevation.de&gt;:<br>
     Initial text.</li>
</ul>
