m4_dnl -*-html-*-
m4_include(`template.m4')

m4_dnl OpenVAS
m4_dnl $Id$
m4_dnl Description: OpenVAS Security Advisory (OVSA20121112)
m4_dnl
m4_dnl Authors:
m4_dnl Tim Brown <timb@openvas.org>
m4_dnl
m4_dnl Copyright:
m4_dnl Copyright (C) 2012 Tim Brown
m4_dnl
m4_dnl This program is free software; you can redistribute it and/or modify
m4_dnl it under the terms of the GNU General Public License version 2,
m4_dnl or, at your option, any later version as published by the Free
m4_dnl Software Foundation
m4_dnl
m4_dnl This program is distributed in the hope that it will be useful,
m4_dnl but WITHOUT ANY WARRANTY; without even the implied warranty of
m4_dnl MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
m4_dnl GNU General Public License for more details.
m4_dnl
m4_dnl You should have received a copy of the GNU General Public License
m4_dnl along with this program; if not, write to the Free Software
m4_dnl Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA 02110-1301 USA.

m4_define(`EN')
m4_define(`TITLE', `OpenVAS')
m4_define(`MAIN', `misc')



PAGE_START
<h2>OpenVAS Security Advisory (OVSA20121112)</h2>

<p>
Date: 12th November 2012<br/>
Product: OpenVAS Manager &lt; 3.0.4 and &lt; 4.0+beta4<br/>
Vendor: OpenVAS &lt;http://www.openvas.org/&gt;<br/>
Risk: Medium
</p>

<h3>Summary</h3>

<p>
It has been identified that OpenVAS Manager is vulnerable to command
injection due to insufficient validation of user supplied data when
processing OMP requests.  It has been identified that this vulnerability
may allow arbitrary code to be executed with the privileges of the
OpenVAS Manager on vulnerable systems.  CVE-2012-5520 has been assigned
to this vulnerability.
</p>

<h3>Current Status</h3>

<p>
As of the 12th November, the state of the vulnerabilities is believed
to be as follows.  A patch has been supplied by Greenbone Networks which
it successfully resolves this vulnerability.  New releases of both 3.0.x
and 4.0.x have also been created which incorporate this patch.
</p>

<h3>Technical Details</h3>

<p>
It has been identified that OpenVAS Manager is vulnerable to command
injection due to insufficient validation of user supplied data when
sending reports to a Sourcefire Defense Center.
</p>

<p>
The processing of requests containing malicious values for the ip address
or port causes the command below to be executed with the privileges of
the OpenVAS Manager (typically root) using the send_to_sourcefire()
function from manage_sql.c:
</p>

<pre>
command = g_strdup_printf ("/bin/sh %s %s %s %s %s &gt; /dev/null"
                               " 2&gt; /dev/null",
                               script,
                               ip,
                               port,
                               pkcs12_file,
                               report_file);

...
if (ret = system (command)...
</pre>

<p>
As you can see, an attacker can influence both the ip address and port
within the concatenated string.
</p>

<p>
The vulnerable code path is only accessible to authenticated users of
OpenVAS Manager.
</p>

<h3>Fix</h3>

<p>
OpenVAS recommends that the publicly available patches are applied.  If
building from source, then either patch r14404, r14405 and r14421 (trunk)
or r14437 (3.0.x) should be obtained from the OpenVAS SVN repository.
A fresh tarball containing the latest stable release can be obtained from:
</p>

<ul>
<li>http://wald.intevation.org/frs/download.php/1212/openvas-manager-3.0.4.tar.gz</li>
</ul>

<p>
In the event that OpenVAS has been supplied as part of a distribution
then the vendor or organisation concerned should be contacted for a
patch.
</p>

<h3>History</h3>

<p>
On the 7th November 2012, Greenbone Networks contacted the OpenVAS security team
to notify them of the vulnerability and request assistance in
coordinating the disclosure.
</p>

<p>
OpenVAS Manager 3.0.4 was released on the 7th.
</p>

<p>
The OpenVAS security team and Greenbone Networks opened a dialogue in order
to draft this advisory and on the 12th November, CVE-2012-5520 was assigned for
this vulnerability.
</p>

<h3>Thanks</h3>

<p>
OpenVAS would like to thank Andre Heinecke of Greenbone Networks for
his help in reporting the vulnerability.
</p>
